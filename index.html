<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BudgetingAja</title>
  <!-- Inline favicon (for local file viewing) -->
  <link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAALhUlEQVR4nH1XfXBVZXr/Pe95zzn35tzP5CYkufkgCUlIIggCy8dC6KoIrlQZiq51pbuDtrtO3ensdsdtpzO9ho6ddreWtV1dtXX9Qq0yMAguuoBQwIUCmqDgCgKBkA8SEpLc3Nzk3nvO+z79I8QFRJ+Z96/z8Xue3/N7fvO8hK8PAjNAxESEiG1XGI31CwIN05ZY+ZHpbFsRQwqzb2g4uWhaQ+HfNN9OJw4c3PCTn/7kt1Pmz12iRtI9A599th8AkEgItLToLwN8VVz1QfHC2ZUqXnJXMF5yhx0IVEvLjvksM+i3bSPfCVEsz/HqYlN835kzn8bS6ZN/+cLTnw9B19iKBwc+PfnMhW3vbQeQARHATAB4EkZ+HXhJXV0sumTu9/Jrqh4qLy6dXl5SQvlOEMVOEPFgGNNK4igMBDGicjje2YG0VtjTd6EpU1TQFJYSBhGMSGhBuLpq62DbJ0917/v9EQDXsHA9A19QXnVb87ySRfPWu46zImQH8G/33s83lcSZlYJpmgIAOs+d6+84d/53m1OXCrq83J2lnsaRzvM6ozz4pQUGQ1imYKWRG05eHL/Y95TqPfPMqW0HU5OA4rrKCUTc8J1V95Qvv/V1WTxlhR0JIyWAEx2dJIUQpmmK9vb23o0bN77yj0888dCS22793ot79v7XpdFxPjrQD08r8hlSMFiw1iI3Msqsta5ccWtJ7b33rBVljRVfsHxNC5gJRLrx7uV3Fy/6xq9z0igxgwGEAk7vyX0HD2xMZ5cuamgorIpEaO++fdseXrfuByDAMAzMbpxpGYEgSceBlXKQSw1DjY2BhEC4upLyp1Ujv6GOU2cv+GXO9V3Nu5hIJiFAxLXL/mR+6dLFGzxTlljhECxDtvcfPvbomaeeW/fxsdbt248fIyLCzTNmzLhr9epa1mwopWg8mQQrBSEMyFAEvoJi+IuKUTJ/DsoXL0SwPE7u2BjMQN7U/MrSvwLD4ccfZwAkAFBLS4ueUl1dVN686AkddKplIABLiDPnN299+PC/bthsCDE6sP/Qs1v27uk5nRzG3FvmLPzWgkX3EZFCIkGahAEArDWgNWBIBMrKEa2dBmFKqGwO7GkoIuFUVT408/5Va4mIE4kECWYGAJq6vPlBsyh2qzIEWKuhz99+52entuzYy8yktIbX2/vh/vf3/PLVvXuyEITblt92/7xVKxeipUX7Q3YG4io5MYOZoV0P7HkAEYQhyEuPcQ5sFM2Z9dPSGTPqW9av14KIODJ1akVBfd26NJjGlefag6OJ9je3bwFAK1eujGzdsWP2pZ6eOzc99vfhufEy5TFj5sybb1qz9sFnIku/sTbd3VMkpKFIiKsGiycO0ZWcGJbfptx4RiMcqqlb0fx9MPskADF71R13uz673mfZmBGKdv5pZZHaNDz86OXh4Vssy6qQplnq9+cVrVm5MgLA0MwQIF69bMWs354//fzl5EivGhmByHNuNNogAKw0DNtGID+fUn197JTF74w31eyUACrDU6u/3Zt1ZRls/beLb59S6gT+WVpmuDIcvoFLAYIIHYOXaVvrEdam9AULIlPHersg/A7yiopBQlzldRPVS9vCaGdPr5dKjYFEtWcYldO/vXKtnLViWTPbViXSGXQP9aJ7aNCpKSqCZobSWjGDhSFITEwMnR8awI5PjuHdzz5BZ3KQTAgWWkPYFkUqSmAXxJDsGsCEtmjiMLP0+Sg7nOzqP/jhvuCspgeVYUyJNdY1y/KFc5dmoAsEMfrTaez+wwnMr65hQxgsDUEADDDj3OBlPtB7EdtPncCp9s+BXBbWFXEFykoRa6xHuCKOkYv9YNV7DWNXhA4YQnYfOnygaVbjYrKsKco0gjK/empTT2okJEyBQCgojra3c8fly6grLhZKa5w+e7a7rbX11XfYndsh6XblelxYUUMqlQTYQ7S2CuGqqZA+G1ppaKVuJIMrYhC+zNBQj4DsYQLSo2ktzWAwitERSxhGLhx0RrqGU7GPerrhd92+PR98sHn3rl2vbHzxxcPz3nhpQ8RybgeIGUQcCCFaWYyCmkp4rgeVyUJI48bAk/ishMrprBAYUiC4rgtJxCYZUrCbSabbL7zneTzr+ZdfPLH94qX/fGPTpiMAFDOL5VvfzGOloJkB1gADQppQngdWamLc6MaVEwgMBmvGlDkz2RBCu0oBzJAGCReCGFoHUh0XWs+9vXv9yVB2ECMYfOutt4x/2vlGGRF1LX7+V+NOPA7leSAQwBqs9dVi/8pgMIgBBvHQuXbWygVJCYAgkckOCqYMSel3ioucnMidwQhQsWxJ1foDu9YZsYolFXcv3+QmkzUUj4OICKy/bpX5cgLMgBBa+mxpuJbtZT0/TBO2bUEmO7o/FSGnQjp+v/T5KlizU7/uz1c5paWP+Ipi3xSGATsaWkxCq8zAJQi/QxMMfHW5k/YOZrBWLG0bphMQ7kgqqdwxn5fLxSX8iEQiQnR++NH/+qQxCBIQsci3Zvz4Bxsj02ufy4uXfFPncuymx9iwbQPQVrqnE5lLPQArEN0gCQYM2yTp5BGINEmpffn5pJWm9m3b97a/vePH5fNujipCE2mNgCFGxNE3t3zgAJ0GA6IkXls4d+4qYdmOOzKiASZhCNLZHFQmB9PJQ6y+GoGSQmi+rv8TGuTxvv6use7ui6bjCGnbou9o26cn/nvjj1r//YX7jj/zm/1OdcUSKxIqtEGDqVPt+2UWuDB2vvPdwPRpy8YVhPAF2I4yualh4WXGoLI5GKaJaF0lChqmI1BciKH2brDS14peMRsBH6fOn3+/7ee/fGF+4rG/Tp44ljz02PoNudHRk0SEyoULp5PjLCfb4qBHF06/t+s1CUCd2blv2+zG+kfGnLzpuawHGQiQ4fcjl0zCkECsoRbBsjiEYUDnPGjPu1phYKW1FXDICoWFzro609n5+30P/+j/rrzhJphFCxEXN03/CyMSmemDQdw/8F7rgUMHBZjp48OHO5Inzz4XsWyPDQPa9QAImKEIYjNuQqSmCswMlcuBmUGmCZIGWGtNhsH+wphw02mc3frO7oG2j19GIgEQuUTkLt2bkC1EevZ9q1da5SUPk+OnfGGcHT7W+jKAzOROyEdfeGVTbWHsAauqap5KpRisabLJ2vUmNh0SYDCr8XEPSpl2NCoMy0TfR63HO7btfLb1yV/9D4DBK/8UzIx9RF5Dc/PsQG3VE14sVFiS57iZU6d/sfONLacSiYSQk43sSneNxgYud06pqpr3x+YyoK+SGoENy6ahY8df7zn2h8/9Qd93u3ZdePfIPzz5bHak/wwRYc2aNcamxkZGS4sGEW65564leU11T3qF+TNikSj8fZdfem39z18FM1qI+IutOOSUGdKybWitr2zINzIUFqYk5eU6T//mpX/pb/v4teG2tksgGr+X2WgEuIVIAUAYiE57YPVqp77279xIeFo0P4rQSHrruR3bHwfRWIJItAD6iwTk2JjHymUzGBA6l2Odc3nCczG547EwTQgpQUJoAHq4ra1j8vmmK8C1CxbEfSUFC4NTK78rCvPvUOFQXiwURDiVfXN476HHDu4+2AMGtdDEDUle8S4aJEpFz5x7WjqBULCivFkGA/DSaWbNTFIKYQhSrseX245r7huYs+CH338gWlo2Jmwrl0sO2dmsKtTQjdqUc2QkdIsOBfP8Th5CQL95se/p869u/o8Pjh8fQiIhQH+8pH6J50BdXaxuzaoH/fH4D514aX1+fRUC0SB0Mqn7T58VQ2fPQSgFnXOhPZ0UAkprbRu25chgCGSZEKzhCCNlpdM7o8Cvn3/0Z+9fhXe9f13TZAIRA0CgqbZh2uo/e6R00byluYs9r5ufnr4Uqojf5Tp5N49rL+ix9ilPWVprEoZUUoiMZRhjflAfJ0cODJ889bvTm7Yd7kgmh4kIfN2teDL+Hx5qXqtTgHxhAAAAAElFTkSuQmCC">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #4CAF50;
            --primary-light: #81C784;
            --primary-dark: #388E3C;
            --secondary: #2196F3;
            --secondary-light: #64B5F6;
            --danger: #F44336;
            --warning: #FF9800;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --white: #ffffff;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 800px;
            margin: 20px auto;
            background: var(--white);
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        }
        
        /* Header Styles */
        .app-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        .app-title {
            color: var(--primary-dark);
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
            letter-spacing: 0.5px;
        }
        
        .tagline {
            color: var(--gray);
            font-size: 14px;
            font-style: italic;
            margin-bottom: 20px;
        }
        
        /* Dashboard Cards */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .card {
            background: var(--white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
            border-top: 4px solid;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        
        .card-income {
            border-color: var(--primary);
        }
        
        .card-expense {
            border-color: var(--danger);
        }
        
        .card-balance {
            border-color: var(--secondary);
        }
        
        .card-title {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .card-title i {
            margin-right: 8px;
            font-size: 16px;
        }
        
        .card-value {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .card-income .card-value {
            color: var(--primary-dark);
        }
        
        .card-expense .card-value {
            color: var(--danger);
        }
        
        .card-balance .card-value {
            color: var(--secondary);
        }
        
        /* Form Styles */
        .form-container {
            background: var(--light);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.03);
        }
        
        .form-title {
            text-align: center;
            color: var(--primary-dark);
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: var(--gray);
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border 0.3s ease;
            background-color: var(--white);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }
        
        /* Button Styles */
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 120px;
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: var(--white);
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-secondary {
            background-color: var(--secondary);
            color: var(--white);
        }
        
        .btn-secondary:hover {
            background-color: #1976D2;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: var(--white);
        }
        
        .btn-danger:hover {
            background-color: #D32F2F;
        }
        
        .btn-warning {
            background-color: var(--warning);
            color: var(--white);
        }
        
        .btn-warning:hover {
            background-color: #F57C00;
        }
        
        /* Table Styles */
        .data-section {
            margin-top: 30px;
        }
        
        .section-title {
            text-align: center;
            color: var(--primary-dark);
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
        }
        
        .search-filter {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .search-box {
            position: relative;
            width: 200px;
        }
        
        .search-box input {
            padding-left: 35px;
        }
        
        .search-box i {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 14px;
            background: var(--white);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background-color: var(--primary);
            color: var(--white);
            font-weight: 500;
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: 0.5px;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        tr:hover {
            background-color: #f1f1f1;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .btn-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            background: transparent;
        }
        
        .btn-edit {
            color: var(--secondary);
        }
        
        .btn-edit:hover {
            background-color: rgba(33, 150, 243, 0.1);
        }
        
        .btn-delete {
            color: var(--danger);
        }
        
        .btn-delete:hover {
            background-color: rgba(244, 67, 54, 0.1);
        }
        
        /* Settings Panel */
        .btn-settings {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 100;
            border: none;
            transition: all 0.3s ease;
        }
        
        .btn-settings:hover {
            transform: rotate(30deg);
            background: var(--primary-dark);
        }
        
        .settings-panel {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            z-index: 99;
            width: 300px;
            transform: translateX(120%);
            transition: transform 0.3s ease;
        }
        
        .settings-panel.active {
            transform: translateX(0);
        }
        
        .settings-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--dark);
            display: flex;
            align-items: center;
        }
        
        .settings-title i {
            margin-right: 8px;
            color: var(--primary);
        }
        
        .settings-form .form-group {
            margin-bottom: 15px;
        }
        
        .settings-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        /* Footer */
        .app-footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            color: var(--gray);
            font-size: 12px;
        }
        
        /* Badge for Transaction Type */
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
        }
        
        .badge-income {
            background-color: rgba(76, 175, 80, 0.1);
            color: var(--primary-dark);
        }
        
        .badge-expense {
            background-color: rgba(244, 67, 54, 0.1);
            color: var(--danger);
        }

        /* Tabs for Report */
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
            color: var(--gray);
        }
        
        .tab.active {
            border-bottom: 2px solid var(--primary);
            color: var(--primary-dark);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Chart Styles */
        .chart-container {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        /* Report Styles */
        .report-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: flex-end;
            flex-wrap: wrap;
        }
        
        .report-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        .report-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .report-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-dark);
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 200;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 25px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--primary-dark);
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }
        
        .close-modal {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
            transition: all 0.3s ease;
        }
        
        .close-modal:hover {
            color: var(--danger);
        }
        
        /* Export Buttons */
        .export-btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        /* Summary Report */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .report-stat {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }
        
        .stat-title {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: 600;
        }
        
        .stat-income {
            color: var(--primary-dark);
        }
        
        .stat-expense {
            color: var(--danger);
        }
        
        .stat-balance {
            color: var(--secondary);
        }
        
        /* Responsive Table - Scroll Horizontal */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
                margin: 5px;
                width: 95%;
            }
            
            .dashboard, .summary-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .form-grid, .report-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: flex;
            }
            
            .btn {
                width: 100%;
                margin-bottom: 5px;
            }
            
            .search-filter, .report-filters {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .search-box {
                width: 100%;
            }
            
            /* Table Responsive dengan Scroll Horizontal */
            .table-responsive {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                margin-bottom: 15px;
                border: 1px solid #ddd;
                border-radius: 8px;
            }
            
            #laporanTable, .report-table {
                min-width: 600px; /* Lebar minimum tabel */
                margin-bottom: 0;
            }
            
            #laporanTable th, 
            #laporanTable td,
            .report-table th,
            .report-table td {
                padding: 8px 10px;
                font-size: 11px;
            }
            
            .action-buttons {
                flex-wrap: nowrap;
            }
            
            .btn-icon {
                width: 28px;
                height: 28px;
                font-size: 12px;
            }
            
            .modal-content {
                width: 95%;
                padding: 15px;
            }
        }

        /* Tambahkan di bagian responsive CSS */
@media (max-width: 768px) {
    .report-table {
        font-size: 12px;
    }
    
    .report-table th, 
    .report-table td {
        padding: 6px 8px;
    }
    
    .report-stat {
        padding: 10px;
    }
    
    .stat-title {
        font-size: 12px;
    }
    
    .stat-value {
        font-size: 16px;
    }
}

@media (min-width: 769px) and (max-width: 1024px) {
    .report-table {
        font-size: 13px;
    }
}

.filter-group {
    margin-bottom: 15px;
}

.filter-control {
    margin-bottom: 15px;
    padding: 10px;
    background-color: #f8f9fa;
    border-radius: 8px;
    transition: all 0.3s ease;
}

.filter-row {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
}

.filter-col {
    flex: 1;
}

@media (max-width: 768px) {
    .filter-row {
        flex-direction: column;
    }
    
    .filter-col {
        width: 100%;
    }
}

       
    </style>

  <!-- Favicon (updated) -->
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32.png">
  <link rel="icon" type="image/png" sizes="192x192" href="favicon-192.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">

  <style>
    .app-logo{
      display:block;
      margin: 6px auto 8px;
      width: clamp(120px, 40vw, 240px); /* min 120px, scales up, caps at 240px */
      height: auto;
    }
  </style>


  <style>
    /* === Dark Aurora Theme === */
    body.theme-aurora {
      --primary: #2EC9B8;
      --primary-light: #86F2E7;
      --primary-dark: #1C7F77;
      --secondary: #34C6BD;
      --secondary-light: #6FE5DE;
      --danger: #F26D6D;
      --warning: #FFB86B;
      --light: rgba(255,255,255,0.06);
      --dark: #E6F8F6;
      --gray: #A6C8C5;
      --white: rgba(255,255,255,0.92);
      color: var(--dark);
      background:
        radial-gradient(1200px 600px at -10% 0%, rgba(183, 230, 224, 0.25), transparent 60%),
        radial-gradient(900px 600px at 110% 10%, rgba(104, 239, 229, 0.30), transparent 55%),
        radial-gradient(800px 500px at 0% 100%, rgba(103, 215, 197, 0.22), transparent 55%),
        radial-gradient(700px 500px at 100% 100%, rgba(58, 167, 160, 0.30), transparent 55%),
        linear-gradient(180deg, #0C1A1F 0%, #0A1418 100%);
      background-attachment: fixed;
    }
    .theme-aurora .container {
      background: rgba(10, 22, 26, 0.65);
      color: #E9F9F7;
      border: 1px solid rgba(255,255,255,0.06);
      box-shadow: 0 12px 40px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.05);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    .theme-aurora .card,
    .theme-aurora .form-container,
    .theme-aurora .report-card,
    .theme-aurora .chart-container,
    .theme-aurora table,
    .theme-aurora .report-stat {
      background: rgba(16, 32, 36, 0.6);
      color: #E9F9F7;
      border: 1px solid rgba(255,255,255,0.06);
      box-shadow: 0 8px 24px rgba(0,0,0,0.35);
    }
    .theme-aurora th {
      background: linear-gradient(90deg, var(--primary-dark), var(--secondary));
      color: #0A1619;
      text-shadow: 0 1px 0 rgba(255,255,255,0.15);
    }
    .theme-aurora .btn-primary { background: var(--primary); color: #082224; }
    .theme-aurora .btn-primary:hover { background: var(--primary-dark); }
    .theme-aurora .btn-secondary { background: var(--secondary); color: #082224; }
    .theme-aurora .btn-secondary:hover { background: #1f9e97; }
    .theme-aurora .btn-danger { background: #ff7676; }
    .theme-aurora .btn-danger:hover { background: #ff5a5a; }
    .theme-aurora input.form-control,
    .theme-aurora select.form-control,
    .theme-aurora .form-control {
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.10);
      color: #E9F9F7;
    }
    .theme-aurora .form-control::placeholder { color: #b7dedd; }
    .theme-aurora .tab.active { color: var(--white); border-bottom-color: var(--primary-light); }
    .theme-aurora .settings-panel { background: rgba(10, 22, 26, 0.9); border: 1px solid rgba(255,255,255,0.06); }
    .theme-aurora .app-title { color: var(--primary-light); text-shadow: 0 2px 12px rgba(104,239,229,0.3); }
    .theme-aurora .app-logo { filter: drop-shadow(0 2px 10px rgba(104, 239, 229, 0.25)); }
    .theme-aurora .btn-settings { background: var(--secondary); }
    .theme-aurora .btn-settings:hover { background: var(--primary); }
    /* Color chips preview */
    .aurora-preview { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
    .aurora-chip { width:26px; height:26px; border-radius:8px; box-shadow: 0 1px 2px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.4); }
    .aurora-chip.a1{ background: #B7E6E0; }
    .aurora-chip.a2{ background: #67D7C5; }
    .aurora-chip.a3{ background: #2F8A84; }
    .aurora-chip.a4{ background: #2A7270; }
    .aurora-chip.a5{ background: #68EFE5; }
    .aurora-chip.a6{ background: #3AA7A0; }
    .aurora-chip.a7{ background: #FFFFFF; border:1px solid #e7eef7; }
    .aurora-chip.a8{ background: #EEF6FF; border:1px solid #dae7ff; }
  </style>


<style>
  /* === Aurora: Zebra fix for annual monthly summary table === */
  body.theme-aurora #annualMonthlySummaryTable tbody tr {
    background: rgba(16,32,36,0.55) !important;
    color: #E9F9F7 !important;
  }
  body.theme-aurora #annualMonthlySummaryTable tbody tr:nth-child(even) {
    background: rgba(16,32,36,0.70) !important;
  }
  body.theme-aurora #annualMonthlySummaryTable tbody tr:hover {
    background: rgba(104,239,229,0.10) !important;
  }
  body.theme-aurora #annualMonthlySummaryTable tbody td,
  body.theme-aurora #annualMonthlySummaryTable tbody td * {
    color: #E9F9F7 !important;
    opacity: 1 !important;
  }
  /* Header tone & borders for consistency */
  body.theme-aurora #annualMonthlySummaryTable thead th {
    background: linear-gradient(90deg, var(--primary-dark), var(--secondary)) !important;
    color: #0A1619 !important;
    border-bottom: 1px solid rgba(255,255,255,0.12) !important;
  }
</style>


<style>
  /* === Aurora Unified Contrast & Zebra Fix (tables + modal) === */
  /* Targets: main history, monthly transactions, monthly summary, annual summary */
  body.theme-aurora #laporanTable tbody tr,
  body.theme-aurora #monthlyTransactionsTable tbody tr,
  body.theme-aurora #monthlySummaryTable tbody tr,
  body.theme-aurora #annualMonthlySummaryTable tbody tr {
    background: rgba(16,32,36,0.55) !important;
    color: #E9F9F7 !important;
  }
  body.theme-aurora #laporanTable tbody tr:nth-child(even),
  body.theme-aurora #monthlyTransactionsTable tbody tr:nth-child(even),
  body.theme-aurora #monthlySummaryTable tbody tr:nth-child(even),
  body.theme-aurora #annualMonthlySummaryTable tbody tr:nth-child(even) {
    background: rgba(16,32,36,0.70) !important;
  }
  body.theme-aurora #laporanTable tbody tr:hover,
  body.theme-aurora #monthlyTransactionsTable tbody tr:hover,
  body.theme-aurora #monthlySummaryTable tbody tr:hover,
  body.theme-aurora #annualMonthlySummaryTable tbody tr:hover {
    background: rgba(104,239,229,0.10) !important;
  }
  body.theme-aurora #laporanTable tbody td,
  body.theme-aurora #laporanTable tbody td *,
  body.theme-aurora #monthlyTransactionsTable tbody td,
  body.theme-aurora #monthlyTransactionsTable tbody td *,
  body.theme-aurora #monthlySummaryTable tbody td,
  body.theme-aurora #monthlySummaryTable tbody td *,
  body.theme-aurora #annualMonthlySummaryTable tbody td,
  body.theme-aurora #annualMonthlySummaryTable tbody td * {
    color: #E9F9F7 !important;
    opacity: 1 !important;
  }
  /* Keep semantic colors for amounts */
  body.theme-aurora #laporanTable .currency.negative,
  body.theme-aurora #monthlyTransactionsTable .currency.negative { color: #ff7676 !important; }
  body.theme-aurora #laporanTable .currency.positive,
  body.theme-aurora #monthlyTransactionsTable .currency.positive { color: #86F2E7 !important; }
  /* Headers look consistent */
  body.theme-aurora #laporanTable thead th,
  body.theme-aurora #monthlyTransactionsTable thead th,
  body.theme-aurora #monthlySummaryTable thead th,
  body.theme-aurora #annualMonthlySummaryTable thead th {
    background: linear-gradient(90deg, var(--primary-dark), var(--secondary)) !important;
    color: #0A1619 !important;
  }

  /* === Modal: force dark content and readable text */
  body.theme-aurora .modal{ 
    background: rgba(0,0,0,0.65) !important;
    backdrop-filter: blur(2px);
    -webkit-backdrop-filter: blur(2px);
  }
  body.theme-aurora .modal .modal-content{
    background: rgba(16,32,36,0.97) !important;
    color: #E9F9F7 !important;
    border: 1px solid rgba(255,255,255,0.12) !important;
    box-shadow: 0 16px 48px rgba(0,0,0,0.5);
  }
  body.theme-aurora .modal .modal-body,
  body.theme-aurora .modal .modal-body *,
  body.theme-aurora #transactionDetail,
  body.theme-aurora #transactionDetail *{
    color: #FFFFFF !important;
    opacity: 1 !important;
  }
  body.theme-aurora .modal .badge, 
  body.theme-aurora .modal .tag{
    background: rgba(255,255,255,0.12) !important;
    border: 1px solid rgba(255,255,255,0.18) !important;
    color: #E9F9F7 !important;
  }
  body.theme-aurora .modal .close-modal{ color:#E9F9F7 !important; }
</style>


<style>
  /* === Aurora: make nominal amounts & key section titles white === */
  /* Nominal amounts: values on cards & tables */
  body.theme-aurora .card .card-value,
  body.theme-aurora .currency {
    color: #FFFFFF !important;
    text-shadow: 0 1px 8px rgba(0,0,0,0.35);
  }
  /* Section titles */
  body.theme-aurora .form-title,         /* Tambah Transaksi Baru */
  body.theme-aurora .section-title {     /* Riwayat Transaksi / other section titles */
    color: #FFFFFF !important;
    text-shadow: 0 1px 8px rgba(0,0,0,0.35);
  }
</style>


<style>
  /* === Aurora: report titles & monthly stat values to white === */
  body.theme-aurora .report-title { 
    color: #FFFFFF !important; 
    text-shadow: 0 1px 8px rgba(0,0,0,0.35);
  }
  body.theme-aurora .stat-value { 
    color: #FFFFFF !important; 
    text-shadow: 0 1px 8px rgba(0,0,0,0.35);
  }
  /* keep expense red for clarity */
  body.theme-aurora .stat-value.stat-expense { 
    color: #ff7676 !important;
    text-shadow: none;
  }
</style>


<style id="riwayat-align-patch">
#laporanTable th:nth-child(3),
#laporanTable th:nth-child(4),
#laporanTable th:nth-child(5),
#laporanTable td:nth-child(3),
#laporanTable td:nth-child(4),
#laporanTable td:nth-child(5){text-align:right;white-space:nowrap;font-variant-numeric:tabular-nums;font-feature-settings:"tnum"}
#laporanTable td:last-child{text-align:right}
#laporanTable td:last-child .action-buttons{display:inline-flex;gap:6px;justify-content:flex-end;align-items:center}
.currency{font-variant-numeric:tabular-nums;font-feature-settings:"tnum";white-space:nowrap}
</style>


<style id="row-divider-fix">
/* Fix: garis pembatas tidak sejajar di kolom AKSI.
   Gunakan border pada <tr> (bukan pada <td>) agar 1 garis penuh per baris. */
#laporanTable{border-collapse:collapse; border-spacing:0}
#laporanTable td, #laporanTable th{border-bottom:none !important}
#laporanTable tbody tr{border-bottom:1px solid rgba(255,255,255,0.14)}
#laporanTable tbody tr:last-child{border-bottom:0}
</style>


<style id="center-keterangan-col">
/* Pusatkan teks di kolom 'Keterangan' (kolom ke-2) */
#laporanTable th:nth-child(2),
#laporanTable td:nth-child(2),
#monthlyTransactionsTable th:nth-child(2),
#monthlyTransactionsTable td:nth-child(2){
  text-align: center;
  vertical-align: middle;
}
</style>


<style id="center-all-headers-clarity">
/* Header tabel lebih jelas & rata tengah di semua tabel */
#laporanTable thead th,
#monthlyTransactionsTable thead th,
#monthlySummaryTable thead th,
#annualMonthlySummaryTable thead th{
  text-align: center !important;
  font-weight: 700;
  letter-spacing: .06em;
  text-transform: uppercase;
  color: rgba(255,255,255,.96); /* kontras tinggi */
  text-shadow: 0 1px 0 rgba(0,0,0,.35); /* sedikit glow agar tetap terbaca di gradient */
  vertical-align: middle;
}

/* Tinggi & padding header konsisten */
#laporanTable thead th,
#monthlyTransactionsTable thead th,
#monthlySummaryTable thead th,
#annualMonthlySummaryTable thead th{
  padding-top: 12px;
  padding-bottom: 12px;
}

/* Garis pemisah bawah header sedikit lebih tegas */
#laporanTable thead tr,
#monthlyTransactionsTable thead tr,
#monthlySummaryTable thead tr,
#annualMonthlySummaryTable thead tr{
  border-bottom: 1.5px solid rgba(255,255,255,0.18);
}
</style>











<style id="date-icon-theme-aurora">
/* Simpan ruang ikon agar tidak ketimpa teks */
input[type="date"]{ padding-right: 36px; }

/* MODE TERANG (default): ikon gelap */
input[type="date"]::-webkit-calendar-picker-indicator{
  opacity: 1 !important;
  background-repeat: no-repeat !important;
  background-position: center !important;
  background-size: 18px 18px !important;
  color: transparent !important;
  filter: none !important;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23000000'><path d='M7 2h2v2h6V2h2v2h3v18H4V4h3V2zm0 6H6v12h12V8H7zm2 2h2v2H9v-2zm0 4h2v2H9v-2zm4-4h2v2h-2v-2zm0 4h2v2h-2v-2z'/></svg>") !important;
}

/* MODE GELAP .theme-aurora: ikon putih (spesifisitas tinggi + !important) */
.theme-aurora input[type="date"]::-webkit-calendar-picker-indicator,
.theme-aurora .filters-dark input[type="date"]::-webkit-calendar-picker-indicator{
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ffffff'><path d='M7 2h2v2h6V2h2v2h3v18H4V4h3V2zm0 6H6v12h12V8H7zm2 2h2v2H9v-2zm0 4h2v2H9v-2zm4-4h2v2h-2v-2zm0 4h2v2h-2v-2z'/></svg>") !important;
  filter: none !important;
}

.theme-aurora input[type="date"]{ color-scheme: dark; }
body:not(.theme-aurora) input[type="date"]{ color-scheme: light; }
</style>





<style id="buttons-theme-match">
/* Palet mengikuti tema (pakai variabel). Fallback: teal & merah. */
:root{
  --_accent-fallback:#14b8a6; /* teal */
  --_danger-fallback:#ef4444; /* red */
}

/* UPDATE -> gunakan warna aksen tema */
.btn-update, .btn-warning, .btn-orange{
  /* gunakan var(--accent) bila ada; jika tidak, fallback */
  --btn-clr: var(--accent, var(--_accent-fallback));
  background: linear-gradient(180deg,
    color-mix(in srgb, var(--btn-clr) 92%, #ffffff 8%),
    color-mix(in srgb, var(--btn-clr) 75%, #000000 25%)
  ) !important;
  color:#fff !important;
  border:1px solid color-mix(in srgb, var(--btn-clr) 65%, #000 35%) !important;
  box-shadow:
    0 8px 24px color-mix(in srgb, var(--btn-clr) 35%, transparent),
    inset 0 1px 0 rgba(255,255,255,.18) !important;
  font-weight:700;
  border-radius:12px;
}
.btn-update:hover, .btn-warning:hover, .btn-orange:hover{
  background: linear-gradient(180deg,
    color-mix(in srgb, var(--btn-clr) 96%, #ffffff 4%),
    color-mix(in srgb, var(--btn-clr) 82%, #000000 18%)
  ) !important;
  transform: translateY(-1px);
}
.btn-update:active, .btn-warning:active, .btn-orange:active{
  transform: translateY(0);
}

/* HAPUS SEMUA -> pakai var(--danger) agar tetap “bahaya” namun selaras */
.btn-danger, .btn-delete, .btn-red{
  --btn-clr: var(--danger, var(--_danger-fallback));
  background: linear-gradient(180deg,
    color-mix(in srgb, var(--btn-clr) 92%, #ffffff 8%),
    color-mix(in srgb, var(--btn-clr) 75%, #000000 25%)
  ) !important;
  color:#fff !important;
  border:1px solid color-mix(in srgb, var(--btn-clr) 65%, #000 35%) !important;
  box-shadow:
    0 8px 24px color-mix(in srgb, var(--btn-clr) 35%, transparent),
    inset 0 1px 0 rgba(255,255,255,.18) !important;
  font-weight:700;
  border-radius:12px;
}
.btn-danger:hover, .btn-delete:hover, .btn-red:hover{
  background: linear-gradient(180deg,
    color-mix(in srgb, var(--btn-clr) 96%, #ffffff 4%),
    color-mix(in srgb, var(--btn-clr) 82%, #000000 18%)
  ) !important;
  transform: translateY(-1px);
}

/* Ikon di tombol ikut putih */
.btn-update i, .btn-warning i, .btn-orange i,
.btn-danger i, .btn-delete i, .btn-red i,
.btn-update svg, .btn-warning svg, .btn-orange svg,
.btn-danger svg, .btn-delete svg, .btn-red svg{
  color:#fff !important;
  fill: currentColor;
}

/* Ring fokus ambil dari warna tombol agar konsisten */
.btn-update:focus-visible, .btn-warning:focus-visible, .btn-orange:focus-visible{
  outline:2px solid color-mix(in srgb, var(--accent, var(--_accent-fallback)) 80%, #fff 20%);
  outline-offset:2px;
}
.btn-danger:focus-visible, .btn-delete:focus-visible, .btn-red:focus-visible{
  outline:2px solid color-mix(in srgb, var(--danger, var(--_danger-fallback)) 80%, #fff 20%);
  outline-offset:2px;
}
</style>


<style id="aksi-badges">
/* === Style ikon AKSI seperti contoh (badge bulat lembut) === */
.action-buttons{ display:inline-flex; gap:10px; align-items:center; justify-content:flex-end; }

.btn-icon{
  width:36px; height:36px;
  display:inline-flex; align-items:center; justify-content:center;
  border-radius:9999px;
  padding:0; border:none; background:transparent;
  box-shadow:none;
  transition:transform .12s ease, box-shadow .12s ease, background-color .12s ease, opacity .12s ease;
}

/* warna dasar ikon */
.btn-icon i, .btn-icon svg{ font-size:16px; line-height:1; }

/* Edit: biru */
.btn-edit{ color:#2563eb; background-color:rgba(59,130,246,.16); }
.btn-edit:hover{ background-color:rgba(59,130,246,.24); transform:translateY(-1px); }
.btn-edit:active{ transform:translateY(0); }
.btn-edit:focus-visible{ outline:2px solid rgba(59,130,246,.45); outline-offset:2px; }

/* Delete: merah */
.btn-delete{ color:#ef4444; background-color:rgba(244,63,94,.16); }
.btn-delete:hover{ background-color:rgba(244,63,94,.24); transform:translateY(-1px); }
.btn-delete:active{ transform:translateY(0); }
.btn-delete:focus-visible{ outline:2px solid rgba(244,63,94,.45); outline-offset:2px; }

/* bayangan lembut agar badge "angkat" dari latar */
.btn-edit, .btn-delete{
  box-shadow: 0 6px 18px rgba(0,0,0,.12), inset 0 1px 0 rgba(255,255,255,.14);
}

/* Tema gelap sedikit naikkan opacity background agar tetap terlihat */
.theme-aurora .btn-edit{ background-color:rgba(59,130,246,.22); }
.theme-aurora .btn-delete{ background-color:rgba(244,63,94,.22); }
.theme-aurora .btn-edit:hover{ background-color:rgba(59,130,246,.30); }
.theme-aurora .btn-delete:hover{ background-color:rgba(244,63,94,.30); }
</style>


<style id="no-smooth-hover">
/* Matikan animasi/hover halus untuk semua tombol */

/* 1) Tombol utama Update & Hapus Semua */
.btn-update, .btn-warning, .btn-orange,
.btn-danger, .btn-delete, .btn-red {
  transition: none !important;
}
.btn-update:hover, .btn-warning:hover, .btn-orange:hover{
  /* kembalikan ke gaya normal (tanpa transform/hover) */
  transform: none !important;
  background: linear-gradient(180deg,
    color-mix(in srgb, var(--btn-clr, var(--accent, #14b8a6)) 92%, #ffffff 8%),
    color-mix(in srgb, var(--btn-clr, var(--accent, #14b8a6)) 75%, #000000 25%)
  ) !important;
  box-shadow:
    0 8px 24px color-mix(in srgb, var(--btn-clr, var(--accent, #14b8a6)) 35%, transparent),
    inset 0 1px 0 rgba(255,255,255,.18) !important;
}
.btn-danger:hover, .btn-delete:hover, .btn-red:hover{
  transform: none !important;
  background: linear-gradient(180deg,
    color-mix(in srgb, var(--btn-clr, var(--danger, #ef4444)) 92%, #ffffff 8%),
    color-mix(in srgb, var(--btn-clr, var(--danger, #ef4444)) 75%, #000000 25%)
  ) !important;
  box-shadow:
    0 8px 24px color-mix(in srgb, var(--btn-clr, var(--danger, #ef4444)) 35%, transparent),
    inset 0 1px 0 rgba(255,255,255,.18) !important;
}

/* 2) Tombol ikon AKSI (edit/hapus) */
.btn-icon, .btn-edit, .btn-delete {
  transition: none !important;
  transform: none !important;
}
/* hover = sama seperti keadaan normal (tanpa perubahan visual) */
.btn-edit:hover{ transform:none !important; }
.btn-delete:hover{ transform:none !important; }
/* Pastikan background saat hover sama dengan default */
.btn-edit:hover{ background-color:rgba(59,130,246,.16) !important; }
.btn-delete:hover{ background-color:rgba(244,63,94,.16) !important; }
.theme-aurora .btn-edit:hover{ background-color:rgba(59,130,246,.22) !important; }
.theme-aurora .btn-delete:hover{ background-color:rgba(244,63,94,.22) !important; }
</style>


<style id="aksi-badges-flat">
/* Ikon AKSI tegas: tanpa glow/menyala, tanpa hover effect */
.btn-icon{ box-shadow:none !important; transition:none !important; }

/* Edit: biru kuat, latar datar */
.btn-edit{
  color:#2563eb !important;
  background-image:none !important;
  background-color:rgba(37,99,235,.18) !important; /* light blue tint */
  box-shadow:none !important;
}
.theme-aurora .btn-edit{ background-color:rgba(37,99,235,.22) !important; }
.btn-edit:hover, .btn-edit:active{ background-color:rgba(37,99,235,.18) !important; transform:none !important; }
.theme-aurora .btn-edit:hover, .theme-aurora .btn-edit:active{ background-color:rgba(37,99,235,.22) !important; }

/* Delete: merah kuat, latar datar */
.btn-delete{
  color:#ef4444 !important;
  background-image:none !important;
  background-color:rgba(239,68,68,.18) !important; /* light red tint */
  box-shadow:none !important;
}
.theme-aurora .btn-delete{ background-color:rgba(239,68,68,.22) !important; }
.btn-delete:hover, .btn-delete:active{ background-color:rgba(239,68,68,.18) !important; transform:none !important; }
.theme-aurora .btn-delete:hover, .theme-aurora .btn-delete:active{ background-color:rgba(239,68,68,.22) !important; }
</style>


<style id="buttons-flat-solid">
/* Tombol flat & tegas: tanpa gradient, tanpa glow, tanpa animasi */
.btn-update, .btn-warning, .btn-orange{
  --btn-clr: var(--accent, #14b8a6);
  background: none !important;
  background-color: var(--btn-clr) !important;
  color:#fff !important;
  border:1px solid color-mix(in srgb, var(--btn-clr) 70%, #000 30%) !important;
  box-shadow:none !important;
  transition:none !important;
  transform:none !important;
  border-radius:12px;
  font-weight:700;
}
.btn-danger, .btn-delete, .btn-red{
  --btn-clr: var(--danger, #ef4444);
  background: none !important;
  background-color: var(--btn-clr) !important;
  color:#fff !important;
  border:1px solid color-mix(in srgb, var(--btn-clr) 70%, #000 30%) !important;
  box-shadow:none !important;
  transition:none !important;
  transform:none !important;
  border-radius:12px;
  font-weight:700;
}

/* Hover/active tetap sama (tanpa efek) */
.btn-update:hover, .btn-warning:hover, .btn-orange:hover,
.btn-update:active, .btn-warning:active, .btn-orange:active{
  background-color: var(--btn-clr) !important;
  box-shadow:none !important;
  transform:none !important;
}
.btn-danger:hover, .btn-delete:hover, .btn-red:hover,
.btn-danger:active, .btn-delete:active, .btn-red:active{
  background-color: var(--btn-clr) !important;
  box-shadow:none !important;
  transform:none !important;
}

/* Ikon di dalam tombol tetap putih & jelas */
.btn-update i, .btn-warning i, .btn-orange i,
.btn-danger i, .btn-delete i, .btn-red i,
.btn-update svg, .btn-warning svg, .btn-orange svg,
.btn-danger svg, .btn-delete svg, .btn-red svg {
  color:#fff !important; fill:currentColor;
}
</style>



































<style id="aurora-logo-pill-light-only-v5">
/* Extra tight capsule */
.logo-pill{
  display:inline-flex;align-items:center;justify-content:center;
  padding:2px 6px;               /* <= lebih kecil lagi */
  border-radius:10px;             /* <= radius diperkecil */
  width:fit-content;margin:0 auto 4px;
}
.logo-pill > img.app-logo{display:block;filter:drop-shadow(0 1px 0 rgba(0,0,0,.28))}

/* LIGHT MODE ONLY — dark glass + compact inner aurora */
body:not(.theme-aurora) .logo-pill{
  position:relative; isolation:isolate;
  background: rgba(12, 18, 28, .92);
  border:1px solid rgba(255,255,255,.14);
  box-shadow: 0 6px 14px rgba(0,0,0,.18);
  overflow:hidden; backdrop-filter: blur(6px) saturate(150%);
}

/* Inner aurora — inset 1px dan blur kecil agar rapat */
body:not(.theme-aurora) .logo-pill::before{
  content:""; position:absolute; inset:1px; border-radius:calc(10px - 1px);
  background:
    radial-gradient(56% 50% at 28% 32%, rgba(16,185,129,.55), transparent 70%),
    radial-gradient(50% 56% at 72% 34%, rgba(59,130,246,.48), transparent 72%),
    radial-gradient(62% 56% at 50% 76%, rgba(20,184,166,.60), transparent 74%);
  filter: blur(8px);
  opacity:.95; z-index:0; pointer-events:none;
}

/* Ring gradasi tipis */
body:not(.theme-aurora) .logo-pill::after{
  content:""; position:absolute; inset:0; border-radius:inherit; padding:.6px;
  background: linear-gradient(120deg,
    rgba(20,184,166,.92), rgba(59,130,246,.85) 50%, rgba(20,184,166,.92));
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor; mask-composite: exclude;
  z-index:1; pointer-events:none;
}

/* DARK MODE — tetap polos */
.theme-aurora .logo-pill{ background:transparent; border:none; box-shadow:none; backdrop-filter:none; overflow:visible }
.theme-aurora .logo-pill::before, .theme-aurora .logo-pill::after{ content:none }
.theme-aurora .logo-pill > img.app-logo{ filter:none }
</style>


<style>
/* ===== Light Aurora (CSS-only, no JS) ===== */
body:not(.theme-aurora){
  --aurora-primary: #14B8A6;       /* teal */
  --aurora-primary-dark: #0F766E;  /* teal gelap */
  --aurora-secondary: #3B82F6;     /* biru */
  --aurora-mint: #5EEAD4;
  --aurora-white: #ffffff;
  --aurora-text: #0B1A1A;
  --aurora-border: rgba(13,148,136,0.12);

  color: var(--aurora-text);
  background:
    radial-gradient(1000px 520px at -10% 0%, rgba(20,184,166,.22), transparent 60%),
    radial-gradient(780px 520px at 110% 10%, rgba(59,130,246,.20), transparent 55%),
    radial-gradient(820px 540px at 0% 100%, rgba(94,234,212,.20), transparent 55%),
    radial-gradient(760px 520px at 100% 100%, rgba(20,184,166,.18), transparent 55%),
    linear-gradient(180deg, #F7FBFB 0%, #F2FAFF 100%);
  background-attachment: fixed;
}

/* Kartu & container */
body:not(.theme-aurora) .container,
body:not(.theme-aurora) .card,
body:not(.theme-aurora) .report-card,
body:not(.theme-aurora) .form-container,
body:not(.theme-aurora) .chart-container,
body:not(.theme-aurora) .report-stat{
  background: rgba(255,255,255,0.92);
  border: 1px solid var(--aurora-border);
  box-shadow: 0 10px 28px rgba(2,62,64,0.08), inset 0 1px 0 rgba(255,255,255,.6);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  color: var(--aurora-text);
}

/* Tab & header aksen */
body:not(.theme-aurora) .nav-tabs .nav-link.active,
body:not(.theme-aurora) .nav-tabs .nav-link.active:hover{
  color:#fff;
  background: linear-gradient(90deg, var(--aurora-primary), var(--aurora-secondary));
  border-color: transparent;
}

body:not(.theme-aurora) .app-title,
body:not(.theme-aurora) .report-title{
  color: var(--aurora-primary-dark);
  text-shadow: 0 1px 0 rgba(255,255,255,.65);
}

/* Tombol utama diselaraskan */
body:not(.theme-aurora) .btn-primary,
body:not(.theme-aurora) .btn-success{
  background: var(--aurora-primary);
  border-color: var(--aurora-primary);
  color:#fff;
}
body:not(.theme-aurora) .btn-primary:hover,
body:not(.theme-aurora) .btn-success:hover{
  background: var(--aurora-primary-dark);
  border-color: var(--aurora-primary-dark);
}
body:not(.theme-aurora) .btn-secondary{
  background: var(--aurora-secondary);
  border-color: var(--aurora-secondary);
  color:#fff;
}
body:not(.theme-aurora) .btn-secondary:hover{
  filter: brightness(.92);
}

/* Form */
body:not(.theme-aurora) .form-control{
  background:#fff;
  border:1px solid rgba(2,62,64,.15);
  color: var(--aurora-text);
}
body:not(.theme-aurora) .form-control::placeholder{ color:#7b9391; }

/* Tabel */
body:not(.theme-aurora) table{
  background:#fff;
  border: 1px solid var(--aurora-border);
}
body:not(.theme-aurora) thead th{
  background: linear-gradient(90deg, var(--aurora-primary), var(--aurora-secondary));
  color:#fff !important;
}
body:not(.theme-aurora) tbody tr:nth-child(even){ background:#F7FCFB; }
body:not(.theme-aurora) tbody tr:hover{ background: rgba(20,184,166,.10); }

/* Angka warna */
body:not(.theme-aurora) .currency.negative{ color:#EF4444 !important; }
body:not(.theme-aurora) .currency.positive{ color: var(--aurora-primary-dark) !important; }

/* Modal */
body:not(.theme-aurora) .modal{ background: rgba(0,0,0,.36); }
body:not(.theme-aurora) .modal .modal-content{
  background:#fff; color: var(--aurora-text);
  border:1px solid var(--aurora-border);
  box-shadow: 0 16px 48px rgba(2,62,64,.10);
}
</style>

<style>
/* ===== Overrides: Light Aurora with teal (#14B8A6) & white base, all text #0F766E ===== */
body:not(.theme-aurora){
  --aurora-primary: #14B8A6 !important;
  --aurora-primary-dark: #0F766E !important;
  --aurora-secondary: #14B8A6 !important; /* unify to teal */
  --aurora-mint: #5EEAD4 !important;
  --aurora-white: #ffffff !important;
  --aurora-text: #0F766E !important;
  --aurora-border: rgba(13,148,136,0.22) !important;

  color: #0F766E !important;
  background:
    radial-gradient(900px 520px at -10% 0%, rgba(20,184,166,.20), transparent 60%),
    radial-gradient(780px 520px at 110% 10%, rgba(20,184,166,.18), transparent 55%),
    radial-gradient(820px 540px at 0% 100%, rgba(20,184,166,.16), transparent 55%),
    radial-gradient(760px 520px at 100% 100%, rgba(20,184,166,.14), transparent 55%),
    linear-gradient(180deg, #ffffff 0%, #ffffff 100%);
  background-attachment: fixed;
}

/* Typography: force all common text to #0F766E */
body:not(.theme-aurora) h1, 
body:not(.theme-aurora) h2, 
body:not(.theme-aurora) h3, 
body:not(.theme-aurora) h4, 
body:not(.theme-aurora) h5, 
body:not(.theme-aurora) h6,
body:not(.theme-aurora) p,
body:not(.theme-aurora) span,
body:not(.theme-aurora) small,
body:not(.theme-aurora) label,
body:not(.theme-aurora) th,
body:not(.theme-aurora) td,
body:not(.theme-aurora) li,
body:not(.theme-aurora) a,
body:not(.theme-aurora) .text-muted,
body:not(.theme-aurora) .text-secondary,
body:not(.theme-aurora) .text-danger,
body:not(.theme-aurora) .text-success,
body:not(.theme-aurora) .app-title,
body:not(.theme-aurora) .report-title{
  color: #0F766E !important;
}

/* Links */
body:not(.theme-aurora) a:hover { opacity: .85; }

/* Cards / containers */
body:not(.theme-aurora) .container,
body:not(.theme-aurora) .card,
body:not(.theme-aurora) .report-card,
body:not(.theme-aurora) .form-container,
body:not(.theme-aurora) .chart-container,
body:not(.theme-aurora) .report-stat{
  background: #ffffff !important;
  border: 1px solid rgba(20,184,166,.22) !important;
  color: #0F766E !important;
  box-shadow: 0 10px 28px rgba(2,62,64,.08);
}

/* Tabs */
body:not(.theme-aurora) .nav-tabs .nav-link{
  color:#0F766E !important;
  background:#fff !important;
  border-color: rgba(20,184,166,.25) !important;
}
body:not(.theme-aurora) .nav-tabs .nav-link.active{
  border-bottom: 3px solid #14B8A6 !important;
}

/* Buttons: all white with teal border/text */
body:not(.theme-aurora) .btn,
body:not(.theme-aurora) .btn-primary,
body:not(.theme-aurora) .btn-secondary,
body:not(.theme-aurora) .btn-success,
body:not(.theme-aurora) .btn-info,
body:not(.theme-aurora) .btn-warning,
body:not(.theme-aurora) .btn-danger{
  background:#ffffff !important;
  color:#0F766E !important;
  border:1px solid rgba(20,184,166,.45) !important;
  box-shadow: none !important;
}
body:not(.theme-aurora) .btn:hover{
  background: rgba(20,184,166,.08) !important;
}

/* Forms */
body:not(.theme-aurora) .form-control{
  background:#fff !important;
  border:1px solid rgba(20,184,166,.30) !important;
  color:#0F766E !important;
}
body:not(.theme-aurora) .form-control::placeholder{ color:#5b8f8b !important; }

/* Tables */
body:not(.theme-aurora) table{ background:#fff !important; }
body:not(.theme-aurora) thead th{
  background: linear-gradient(90deg, #ffffff 0%, rgba(20,184,166,.12) 50%, #ffffff 100%) !important;
  color:#0F766E !important;
  border-bottom: 1px solid rgba(20,184,166,.35) !important;
}
body:not(.theme-aurora) tbody tr:nth-child(even){ background:#F0FDFB !important; }
body:not(.theme-aurora) tbody tr:hover{ background: rgba(20,184,166,.10) !important; }

/* Currency colors: seragam #0F766E */
body:not(.theme-aurora) .currency.negative,
body:not(.theme-aurora) .currency.positive{ color:#0F766E !important; }

/* Modal */
body:not(.theme-aurora) .modal{ background: rgba(0,0,0,.25) !important; }
body:not(.theme-aurora) .modal .modal-content{
  background:#fff !important; color:#0F766E !important;
  border:1px solid rgba(20,184,166,.22) !important;
}
</style>

<style>
/* === FINAL TWEAKS (LIGHT ONLY) === */

/* 1) Tabs active = #0F766E + underline */
body:not(.theme-aurora) .tabs .tab.active{
  color:#0F766E !important;
  border-bottom:3px solid #0F766E !important;
}
body:not(.theme-aurora) .tabs .tab{ color:rgba(15,118,110,0.60); }

/* 2) All nominal/amounts */
body:not(.theme-aurora) .currency,
body:not(.theme-aurora) .card .card-value,
body:not(.theme-aurora) .report-card .card-value,
body:not(.theme-aurora) .amount, 
body:not(.theme-aurora) .nominal, 
body:not(.theme-aurora) .money, 
body:not(.theme-aurora) .total-amount,
body:not(.theme-aurora) .stat-number,
body:not(.theme-aurora) .text-success,
body:not(.theme-aurora) .text-danger,
body:not(.theme-aurora) .text-primary{
  color:#0F766E !important;
}
/* Tables numeric columns fallback */
body:not(.theme-aurora) #laporanTable td:nth-child(3),
body:not(.theme-aurora) #laporanTable td:nth-child(4),
body:not(.theme-aurora) #laporanTable td:nth-child(5){
  color:#0F766E !important;
}

/* 3) Glossy glass for Settings panel when ACTIVE */
body:not(.theme-aurora) .settings-panel.active{
  transform: translateX(0) !important;
  background: linear-gradient(180deg, rgba(255,255,255,0.72), rgba(255,255,255,0.48))
              ,radial-gradient(600px 240px at -10% -20%, rgba(20,184,166,0.18), transparent 60%)
              ,radial-gradient(500px 220px at 110% -10%, rgba(20,184,166,0.14), transparent 60%) !important;
  border: 1px solid rgba(20,184,166,0.22) !important;
  box-shadow: 0 18px 40px rgba(2,62,64,0.12), inset 0 1px 0 rgba(255,255,255,0.65) !important;
  backdrop-filter: blur(10px) saturate(1.05) !important;
  -webkit-backdrop-filter: blur(10px) saturate(1.05) !important;
}
/* Keep panel not-active as default white (no change) */

/* 4) Glossy glass for settings gear button */
body:not(.theme-aurora) .btn-settings{
  background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.35))
              ,radial-gradient(200px 160px at 30% 0%, rgba(20,184,166,0.18), transparent 70%) !important;
  color:#0F766E !important;
  border:1px solid rgba(20,184,166,0.28) !important;
  box-shadow: 0 8px 22px rgba(2,62,64,0.18), inset 0 1px 0 rgba(255,255,255,0.75) !important;
  backdrop-filter: blur(6px) saturate(1.05) !important;
  -webkit-backdrop-filter: blur(6px) saturate(1.05) !important;
}
body:not(.theme-aurora) .btn-settings i{ color:#0F766E !important; }
body:not(.theme-aurora) .btn-settings:hover{
  transform: translateY(-1px);
  box-shadow: 0 10px 28px rgba(2,62,64,0.22), inset 0 1px 0 rgba(255,255,255,0.85) !important;
}
</style>

<style>
/* === Glossy icon for settings title (LIGHT only) === */
body:not(.theme-aurora) .settings-panel .settings-title i{
  display:inline-flex; align-items:center; justify-content:center;
  width:28px; height:28px; border-radius:50%; margin-right:8px;
  color:#0F766E !important;
  background:
    linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.35)),
    radial-gradient(120px 80px at 30% 0%, rgba(20,184,166,0.20), transparent 70%);
  border:1px solid rgba(20,184,166,0.30);
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.80), 0 4px 10px rgba(2,62,64,0.12);
  backdrop-filter: blur(6px) saturate(1.05);
  -webkit-backdrop-filter: blur(6px) saturate(1.05);
}
</style>

<style>
/* === LIGHT ONLY: unify Monthly/Annual totals to #0F766E === */
body:not(.theme-aurora) .summary-grid .stat-value,
body:not(.theme-aurora) .stat-income,
body:not(.theme-aurora) .stat-expense,
body:not(.theme-aurora) .stat-balance{
  color:#0F766E !important;
}
</style>

<style id="fix-button-icons-v2">
  /* Ensure icons inherit the button text color across all states */
  .btn i, .btn svg { color: currentColor !important; fill: currentColor !important; stroke: currentColor !important; }
  /* Explicitly override common button variants that previously forced white icons */
  .btn-danger i, .btn-danger svg,
  .btn-warning i, .btn-warning svg,
  .btn-success i, .btn-success svg,
  .btn-primary i, .btn-primary svg,
  .btn-outline i, .btn-outline svg {
    color: currentColor !important;
    fill: currentColor !important;
    stroke: currentColor !important;
  }
</style>


<style id="icon-red-glass">
  :root { --glass-red: 239, 68, 68; } /* Tailwind red-500 approx */

  /* Make the TRASH icon itself look like red glass (gradient on glyph) */
  i.icon-glass-red {
    background: linear-gradient(180deg,
      #ffffff 0%, rgba(255,255,255,.85) 18%, rgba(255,255,255,.45) 35%,
      rgba(var(--glass-red), .98) 100%);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent !important;      /* override currentColor rule */
    filter: drop-shadow(0 1px 0 rgba(255,255,255,.6))
            drop-shadow(0 2px 6px rgba(var(--glass-red), .45));
  }

  /* Auto style the button that CONTAINS a red-glass icon to look lightly glassy */
  button:has(i.icon-glass-red),
  a:has(i.icon-glass-red) {
    background:
      radial-gradient(90% 100% at 30% 25%, rgba(255,255,255,.55) 0, rgba(255,255,255,0) 42%),
      linear-gradient(135deg, rgba(var(--glass-red), .10) 0%, rgba(var(--glass-red), .18) 100%);
    border: 1px solid rgba(var(--glass-red), .35);
    box-shadow:
      inset 0 1px 0 rgba(255,255,255,.45),
      inset 0 -8px 16px rgba(0,0,0,.05),
      0 4px 12px rgba(var(--glass-red), .25);
    backdrop-filter: blur(8px) saturate(150%);
    -webkit-backdrop-filter: blur(8px) saturate(150%);
    color: rgba(var(--glass-red), .95);
    transition: box-shadow .2s, transform .06s, background .2s;
  }
  button:has(i.icon-glass-red):hover,
  a:has(i.icon-glass-red):hover {
    background:
      radial-gradient(90% 100% at 30% 25%, rgba(255,255,255,.6) 0, rgba(255,255,255,0) 45%),
      linear-gradient(135deg, rgba(var(--glass-red), .16) 0%, rgba(var(--glass-red), .26) 100%);
    box-shadow:
      inset 0 1px 0 rgba(255,255,255,.5),
      inset 0 -10px 18px rgba(0,0,0,.06),
      0 6px 16px rgba(var(--glass-red), .35);
  }
  button:has(i.icon-glass-red):active,
  a:has(i.icon-glass-red):active {
    transform: translateY(1px);
    box-shadow: inset 0 2px 6px rgba(0,0,0,.12), 0 2px 8px rgba(var(--glass-red),.25);
  }

  /* If your icon buttons are circles/squircles, ensure visuals are neat */
  button:has(i.icon-glass-red), a:has(i.icon-glass-red){
    border-radius: 12px;
  }
</style>


<style id="red-glass-button-only">
  :root { --glass-red: 239, 68, 68; } /* ~ red-500 */

  /* 1) Pastikan ikon kembali mengikuti warna teks tombol (bukan gradasi di glyph) */
  i.icon-glass-red {
    background: none !important;
    -webkit-background-clip: initial !important;
    background-clip: initial !important;
    color: currentColor !important;
    filter: none !important;
  }

  /* 2) Efek GLASS MERAH pada BACKGROUND tombol yang berisi ikon trash */
  button:has(i.fa-trash), button:has(i.fa-trash-alt),
  a:has(i.fa-trash), a:has(i.fa-trash-alt) {
    background:
      radial-gradient(90% 100% at 30% 25%, rgba(255,255,255,.55) 0, rgba(255,255,255,0) 42%),
      linear-gradient(135deg, rgba(var(--glass-red), .70) 0%, rgba(var(--glass-red), .90) 100%);
    border: 1px solid rgba(var(--glass-red), .85);
    color: #fff; /* ikon jadi putih berkat aturan currentColor */
    box-shadow:
      inset 0 1px 0 rgba(255,255,255,.45),
      inset 0 -8px 16px rgba(0,0,0,.18),
      0 4px 12px rgba(var(--glass-red), .35);
    backdrop-filter: blur(8px) saturate(160%);
    -webkit-backdrop-filter: blur(8px) saturate(160%);
    transition: transform .06s, box-shadow .2s, background .2s;
    border-radius: 12px;
  }

  button:has(i.fa-trash):hover, button:has(i.fa-trash-alt):hover,
  a:has(i.fa-trash):hover, a:has(i.fa-trash-alt):hover {
    background:
      radial-gradient(90% 100% at 30% 25%, rgba(255,255,255,.60) 0, rgba(255,255,255,0) 45%),
      linear-gradient(135deg, rgba(var(--glass-red), .78) 0%, rgba(var(--glass-red), .98) 100%);
    box-shadow:
      inset 0 1px 0 rgba(255,255,255,.5),
      inset 0 -10px 18px rgba(0,0,0,.22),
      0 6px 16px rgba(var(--glass-red), .45);
  }

  button:has(i.fa-trash):active, button:has(i.fa-trash-alt):active,
  a:has(i.fa-trash):active, a:has(i.fa-trash-alt):active {
    transform: translateY(1px);
    box-shadow: inset 0 2px 6px rgba(0,0,0,.25), 0 2px 8px rgba(var(--glass-red),.35);
  }
</style>


<style id="footer-substyle">
  .footer-sub{
    display:block;
    margin-top:4px;
    font-size:.92rem;
    opacity:.9;
  }
</style>
</head>
<body onload="loadData()">
    <!-- Settings Button -->
    <button class="btn-settings" onclick="toggleSettings()">
        <i class="fas fa-cog"></i>
    </button>
    
    <!-- Settings Panel -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-title">
            <i class="fas fa-cog"></i> Pengaturan Aplikasi
        </div>
        <div class="settings-form">

            <div class="form-group">
                <label for="themeSelect">Tema</label>
                <select id="themeSelect" class="form-control">
                    <option value="light">Light (Default)</option>
                    <option value="aurora">Dark Gradient Aurora</option>
                </select>
                <div class="aurora-preview">
                    <div class="aurora-chip a1"></div>
                    <div class="aurora-chip a2"></div>
                    <div class="aurora-chip a3"></div>
                    <div class="aurora-chip a4"></div>
                    <div class="aurora-chip a5"></div>
                    <div class="aurora-chip a6"></div>
                    <div class="aurora-chip a7"></div>
                    <div class="aurora-chip a8"></div>
                </div>
            </div>

            <div class="form-group">
                <label for="customTitle">Judul Aplikasi</label>
                <input type="text" id="customTitle" class="form-control" placeholder="Masukkan judul baru">
            </div>
            <div class="settings-actions">
                <button class="btn btn-primary" onclick="saveTitle()">
                    <i class="fas fa-save"></i> Simpan
                </button>
                <button class="btn btn-danger" onclick="document.getElementById('settingsPanel').classList.remove('active')">
                    <i class="fas fa-times"></i> Batal
                </button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <!-- App Header -->
        <div class="app-header">
    <img src="data:image/png;base64,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" alt="BudgetingAja Logo" class="app-logo">

            <h1 class="app-title" id="laporanTitle">LAPORAN KEUANGAN HARIAN</h1>
</div>
        
        <!-- Tabs Navigation -->
        <div class="tabs">
            <div class="tab active" onclick="openTab('transaksi')">
                <i class="fas fa-exchange-alt"></i> Transaksi
            </div>
            <div class="tab" onclick="openTab('laporan')">
                <i class="fas fa-chart-bar"></i> Laporan
            </div>
        </div>
        
        <!-- Transaksi Tab -->
        <div id="transaksi" class="tab-content active">
            <!-- Dashboard Cards -->
            <div class="dashboard">
                <div class="card card-income">
                    <div class="card-title">
                        <i class="fas fa-wallet"></i> Pemasukan
                    </div>
                    <div class="card-value currency" id="totalPemasukan">Rp 0</div>
                </div>
                
                <div class="card card-expense">
                    <div class="card-title">
                        <i class="fas fa-shopping-bag"></i> Pengeluaran
                    </div>
                    <div class="card-value currency" id="totalPengeluaran">Rp 0</div>
                </div>
                
                <div class="card card-balance">
                    <div class="card-title">
                        <i class="fas fa-piggy-bank"></i> Saldo Akhir
                    </div>
                    <div class="card-value currency" id="saldoAkhir">Rp 0</div>
                </div>
            </div>
            
            <!-- Transaction Form -->
            <div class="form-container">
                <h3 class="form-title">Tambah Transaksi Baru</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="tanggal">Tanggal</label>
                        <input type="date" id="tanggal" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="keterangan">Keterangan</label>
                        <input type="text" id="keterangan" class="form-control" placeholder="Deskripsi transaksi">
                    </div>
                    <div class="form-group">
                        <label for="tipe">Jenis Transaksi</label>
                        <select id="tipe" class="form-control">
                            <option value="pemasukan">Pemasukan</option>
                            <option value="pengeluaran">Pengeluaran</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="jumlah">Jumlah (Rp)</label>
                        <input type="text" id="jumlah" class="form-control" placeholder="0" inputmode="numeric">
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-primary" onclick="tambahTransaksi()">
                        <i class="fas fa-plus"></i> Tambah
                    </button>
                    <button class="btn btn-warning" onclick="updateTransaksi()">
                        <i class="fas fa-sync"></i> Update
                    </button>
                    <button class="btn btn-danger" onclick="clearData()">
                        <i class="icon-glass-red fas fa-trash"></i> Hapus Semua
                    </button>
                </div>
                
                <div class="export-btn-group">
                    <button class="btn btn-secondary" onclick="simpanPDF()">
                        <i class="fas fa-file-pdf"></i> Export PDF
                    </button>
                    <button class="btn btn-secondary" onclick="exportExcel()">
                        <i class="fas fa-file-excel"></i> Export Excel
                    </button>
                </div>
            </div>
            
            <!-- Transaction Data -->
            <div class="data-section">
                <h3 class="section-title">Riwayat Transaksi</h3>
                
                <div class="search-filter">
                    <div class="filter-group">
                        <label for="filterType">Filter Berdasarkan:</label>
                        <select id="filterType" class="form-control" onchange="changeFilterType()">
                            <option value="all">Semua Transaksi</option>
                            <option value="date">Tanggal Tertentu</option>
                            <option value="month">Bulan Tertentu</option>
                            <option value="range">Rentang Tanggal</option>
                        </select>
                    </div>
                
                    <!-- Filter Tanggal Tertentu -->
                    <div class="filter-control" id="dateFilterControl" style="display: none;">
                        <label for="filterDate">Pilih Tanggal:</label>
                        <input type="date" id="filterDate" class="form-control" onchange="filterTransactions()">
                    </div>
                
                    <!-- Filter Bulan Tertentu -->
                    <div class="filter-control" id="monthFilterControl" style="display: none;">
                        <div class="filter-row">
                            <div class="filter-col">
                                <label for="filterMonth">Bulan:</label>
                                <select id="filterMonth" class="form-control" onchange="filterTransactions()">
                                    <option value="01">Januari</option>
                                    <option value="02">Februari</option>
                                    <option value="03">Maret</option>
                                    <option value="04">April</option>
                                    <option value="05">Mei</option>
                                    <option value="06">Juni</option>
                                    <option value="07">Juli</option>
                                    <option value="08">Agustus</option>
                                    <option value="09">September</option>
                                    <option value="10">Oktober</option>
                                    <option value="11">November</option>
                                    <option value="12">Desember</option>
                                </select>
                            </div>
                            <div class="filter-col">
                                <label for="filterYear">Tahun:</label>
                                <select id="filterYear" class="form-control" onchange="filterTransactions()">
                                    <!-- Tahun akan diisi oleh JavaScript -->
                                </select>
                            </div>
                        </div>
                    </div>
                
                    <!-- Filter Rentang Tanggal -->
                    <div class="filter-control" id="rangeFilterControl" style="display: none;">
                        <div class="filter-row">
                            <div class="filter-col">
                                <label for="filterStartDate">Dari:</label>
                                <input type="date" id="filterStartDate" class="form-control" onchange="filterTransactions()">
                            </div>
                            <div class="filter-col">
                                <label for="filterEndDate">Sampai:</label>
                                <input type="date" id="filterEndDate" class="form-control" onchange="filterTransactions()">
                            </div>
                        </div>
                    </div>
                
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" class="form-control" placeholder="Cari transaksi..." id="searchInput" oninput="filterTransactions()">
                    </div>
                </div>
                
                <!-- Tambahkan div wrapper untuk tabel -->
                <div class="table-responsive">
                    <table id="laporanTable" class="report-table">
                        <thead>
                            <tr>
                                <th>Tanggal</th>
                                <th>Keterangan</th>
                                <th>Pemasukan</th>
                                <th>Pengeluaran</th>
                                <th>Saldo</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="data-keuangan"></tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Laporan Tab -->
        <div id="laporan" class="tab-content">
            <h3 class="section-title">Rekap Laporan Keuangan</h3>
            
            <div class="tabs">
                <div class="tab active" onclick="openReportTab('bulanan')">
                    <i class="fas fa-calendar-alt"></i> Laporan Bulanan
                </div>
                <div class="tab" onclick="openReportTab('tahunan')">
                    <i class="fas fa-calendar-check"></i> Laporan Tahunan
                </div>
            </div>
            
            <!-- Laporan Bulanan -->
            <div id="bulanan" class="tab-content active">
                <div class="report-filters">
                    <div class="form-group">
                        <label for="reportMonth">Pilih Bulan:</label>
                        <select id="reportMonth" class="form-control" onchange="generateMonthlyReport()">
                            <option value="01">Januari</option>
                            <option value="02">Februari</option>
                            <option value="03">Maret</option>
                            <option value="04">April</option>
                            <option value="05">Mei</option>
                            <option value="06">Juni</option>
                            <option value="07">Juli</option>
                            <option value="08">Agustus</option>
                            <option value="09">September</option>
                            <option value="10">Oktober</option>
                            <option value="11">November</option>
                            <option value="12">Desember</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="reportMonthYear">Pilih Tahun:</label>
                        <select id="reportMonthYear" class="form-control" onchange="generateMonthlyReport()">
                            <!-- Akan diisi dengan script -->
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="generateMonthlyReport()">
                        <i class="fas fa-sync"></i> Tampilkan
                    </button>
                    <div class="export-btn-group">
                        <button class="btn btn-secondary" onclick="exportMonthlyPDF()">
                            <i class="fas fa-file-pdf"></i> PDF
                        </button>
                        <button class="btn btn-secondary" onclick="exportMonthlyExcel()">
                            <i class="fas fa-file-excel"></i> Excel
                        </button>
                    </div>
                </div>
                
                <div class="summary-grid">
                    <div class="report-stat">
                        <div class="stat-title">Total Pemasukan</div>
                        <div class="stat-value stat-income" id="monthlyIncome">Rp 0</div>
                    </div>
                    <div class="report-stat">
                        <div class="stat-title">Total Pengeluaran</div>
                        <div class="stat-value stat-expense" id="monthlyExpense">Rp 0</div>
                    </div>
                    <div class="report-stat">
                        <div class="stat-title">Saldo</div>
                        <div class="stat-value stat-balance" id="monthlyBalance">Rp 0</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="monthlyChart"></canvas>
                </div>
                
                
                    <div class="report-card">
                        <h4 class="report-title">Ringkasan Bulanan</h4>
                        <div class="table-responsive">
                            <table class="report-table" id="monthlySummaryTable">
                                <thead>
                                    <tr>
                                        <th>Bulan</th>
                                        <th>Pemasukan</th>
                                        <th>Pengeluaran</th>
                                        <th>Saldo</th>
                                    </tr>
                                </thead>
                                <tbody id="monthlySummary"></tbody>
                            </table>
                        </div>
                    </div>
                
                
                <div class="report-card">
                    <h4 class="report-title">Transaksi Bulanan</h4>
                    <div class="table-responsive">
                        <table class="report-table" id="monthlyTransactionsTable">
                            <thead>
                                <tr>
                                    <th>Tanggal</th>
                                    <th>Keterangan</th>
                                    <th>Pemasukan</th>
                                    <th>Pengeluaran</th>
                                    <th>Saldo</th>
                                </tr>
                            </thead>
                            <tbody id="monthlyTransactions"></tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Laporan Tahunan -->
            <div id="tahunan" class="tab-content">
                <div class="report-filters">
                    <div class="form-group">
                        <label for="filterYearAnnual">Pilih Tahun:</label>
                        <select id="filterYearAnnual" class="form-control" onchange="generateAnnualReport()">
                            <!-- Akan diisi dengan script -->
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="generateAnnualReport()">
                        <i class="fas fa-sync"></i> Tampilkan
                    </button>
                    <div class="export-btn-group">
                        <button class="btn btn-secondary" onclick="exportAnnualPDF()">
                            <i class="fas fa-file-pdf"></i> PDF
                        </button>
                        <button class="btn btn-secondary" onclick="exportAnnualExcel()">
                            <i class="fas fa-file-excel"></i> Excel
                        </button>
                    </div>
                </div>
                
                <div class="summary-grid">
                    <div class="report-stat">
                        <div class="stat-title">Total Pemasukan</div>
                        <div class="stat-value stat-income" id="annualIncome">Rp 0</div>
                    </div>
                    <div class="report-stat">
                        <div class="stat-title">Total Pengeluaran</div>
                        <div class="stat-value stat-expense" id="annualExpense">Rp 0</div>
                    </div>
                    <div class="report-stat">
                        <div class="stat-title">Saldo</div>
                        <div class="stat-value stat-balance" id="annualBalance">Rp 0</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="annualChart"></canvas>
                </div>
                
                
                    <div class="report-card">
                        <h4 class="report-title">Ringkasan Bulanan</h4>
                        <div class="table-responsive">
                            <table class="report-table" id="annualMonthlySummaryTable">
                                <thead>
                                    <tr>
                                        <th>Bulan</th>
                                        <th>Pemasukan</th>
                                        <th>Pengeluaran</th>
                                        <th>Saldo</th>
                                    </tr>
                                </thead>
                                <tbody id="annualMonthlySummary"></tbody>
                            </table>
                        </div>
                    </div>
                
            </div>
        </div>
        
        <!-- App Footer -->
        <div class="app-footer">
            <p>Langkah kecil, hasil finansial besar<br><span class="footer-sub">BudgetingAja by Adraa</span></p>
        </div>
    </div>
    
    <!-- Modal for Transaction Detail -->
    <div class="modal" id="transactionModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h3 class="modal-title">Detail Transaksi</h3>
            <div id="transactionDetail"></div>
        </div>
    </div>
    
    <script>
        // Deklarasi variabel global
        let transactions = [];
        let editingId = null;
        let monthlyChart = null;
        let annualChart = null;
        let categoryChart = null;
        
        // Inisialisasi jsPDF
        const { jsPDF } = window.jspdf;
        
        // Fungsi untuk memuat data dari localStorage
        function loadData() {
            const savedData = localStorage.getItem('financialTransactions');
            const savedTitle = localStorage.getItem('appTitle');
            
            if (savedData) {
        transactions = JSON.parse(savedData);
        updateTransactionTable();
        calculateTotals();
    }
    
    if (savedTitle) {
        document.getElementById('laporanTitle').textContent = savedTitle;
    } else {
        // Set default title if not exists
        localStorage.setItem('appTitle', 'Laporan Keuangan Harian');
    }
            
            // Isi tahun untuk filter
            fillYearDropdowns();
            initReportYearFilter(); // Untuk laporan bulanan
            initAnnualYearFilter(); // Untuk laporan tahunan
            
             // Set bulan dan tahun saat ini
             const currentDate = new Date();
            document.getElementById('tanggal').valueAsDate = currentDate;
            document.getElementById('reportMonth').value = (currentDate.getMonth() + 1).toString().padStart(2, '0');
            document.getElementById('reportMonthYear').value = currentDate.getFullYear();
            document.getElementById('filterYearAnnual').value = currentDate.getFullYear();
            
            // Generate laporan awal
            generateMonthlyReport();
            
            // Setup input jumlah
            setupAmountInput();
        }
        
        // Setup input jumlah dengan formatter
        function setupAmountInput() {
            const amountInput = document.getElementById('jumlah');
            
            // Format saat input
            amountInput.addEventListener('input', function(e) {
                formatInputNumber(this);
            });
            
            // Handle paste
            amountInput.addEventListener('paste', function(e) {
                e.preventDefault();
                const pastedText = (e.clipboardData || window.clipboardData).getData('text');
                const numericString = pastedText.replace(/[^\d]/g, '');
                document.execCommand('insertText', false, numericString);
                formatInputNumber(this);
            });
        }
        
        // Fungsi untuk memformat input dengan separator ribuan tanpa batas
        function formatInputNumber(input) {
            // Simpan posisi kursor dan nilai sebelum perubahan
            const cursorPosition = input.selectionStart;
            const originalValue = input.value;
            const originalLength = originalValue.length;
            
            // Dapatkan angka saja (hapus semua non-digit)
            let numericString = originalValue.replace(/[^\d]/g, '');
            
            // Jika kosong, set ke string kosong
            if (numericString === '') {
                input.value = '';
                return;
            }
            
            // Format dengan separator ribuan menggunakan BigInt untuk nilai sangat besar
            const formattedValue = new Intl.NumberFormat('id-ID').format(BigInt(numericString));
            
            // Update nilai input
            input.value = formattedValue;
            
            // Hitung posisi kursor baru
            let newCursorPosition = cursorPosition;
            
            // Adjust cursor position based on added/removed separators
            const separatorDiff = (formattedValue.match(/\./g)?.length || 0) - (originalValue.match(/\./g)?.length || 0);
            newCursorPosition = cursorPosition + separatorDiff;
            
            // Pastikan posisi kursor valid
            newCursorPosition = Math.max(0, Math.min(newCursorPosition, formattedValue.length));
            input.setSelectionRange(newCursorPosition, newCursorPosition);
        }
        
        // Fungsi untuk mendapatkan nilai numerik (string)
        function getNumericValue(formattedValue) {
            return formattedValue.replace(/[^\d]/g, '') || '0';
        }
        
        // Fungsi untuk mengisi dropdown tahun
        function fillYearDropdowns() {
    const currentYear = new Date().getFullYear();
    
    // Update untuk semua dropdown tahun di aplikasi
    const yearDropdowns = [
        document.getElementById('filterYear'),         // Filter bulanan
        document.getElementById('filterYearAnnual'),   // Filter tahunan
        document.getElementById('reportMonthYear')     // Laporan bulanan
    ];
    
    yearDropdowns.forEach(dropdown => {
        if (!dropdown) return;
        
        // Kosongkan dropdown
        dropdown.innerHTML = '';
        
        // Tambahkan tahun dari currentYear - 5 hingga 2030
        for (let year = currentYear - 5; year <= 2030; year++) {
            const option = document.createElement('option');
            option.value = year;
            option.textContent = year;
            
            // Set tahun saat ini sebagai selected
            if (year === currentYear) {
                option.selected = true;
            }
            
            dropdown.appendChild(option);
        }
    });
}

        
        // Fungsi untuk menambah transaksi baru dengan penanganan jumlah tanpa batas
        function tambahTransaksi() {
            const tanggal = document.getElementById('tanggal').value;
            const keterangan = document.getElementById('keterangan').value.trim();
            const tipe = document.getElementById('tipe').value;
            const jumlahInput = document.getElementById('jumlah');
            const jumlah = getNumericValue(jumlahInput.value);
            
            // Validasi input
            if (!tanggal || !keterangan || jumlah === '0') {
                alert('Harap isi semua field dengan benar!');
                return;
            }
            
            // Konversi ke number (BigInt jika perlu)
            const amount = Number(jumlah);
            
            // Buat objek transaksi
            const transaction = {
                id: Date.now(),
                tanggal,
                keterangan,
                tipe,
                jumlah: amount,
                saldo: 0 // Akan dihitung saat update
            };
            
            // Tambahkan ke array
            transactions.push(transaction);
            
            // Simpan ke localStorage
            saveData();
            
            // Update tampilan
            updateTransactionTable();
            calculateTotals();
            
            // Reset form
            document.getElementById('keterangan').value = '';
            document.getElementById('jumlah').value = '';
            document.getElementById('keterangan').focus();
        }
        
        // Fungsi untuk mengupdate transaksi dengan penanganan jumlah tanpa batas
        function updateTransaksi() {
            if (editingId === null) {
                alert('Tidak ada transaksi yang dipilih untuk diupdate!');
                return;
            }
            
            const tanggal = document.getElementById('tanggal').value;
            const keterangan = document.getElementById('keterangan').value.trim();
            const tipe = document.getElementById('tipe').value;
            const jumlahInput = document.getElementById('jumlah');
            const jumlah = getNumericValue(jumlahInput.value);
            
            // Validasi input
            if (!tanggal || !keterangan || jumlah === '0') {
                alert('Harap isi semua field dengan benar!');
                return;
            }
            
            // Konversi ke number
            const amount = Number(jumlah);
            
            // Cari transaksi yang akan diupdate
            const index = transactions.findIndex(t => t.id === editingId);
            if (index !== -1) {
                transactions[index] = {
                    id: editingId,
                    tanggal,
                    keterangan,
                    tipe,
                    jumlah: amount,
                    saldo: 0 // Akan dihitung saat update
                };
                
                // Simpan ke localStorage
                saveData();
                
                // Update tampilan
                updateTransactionTable();
                calculateTotals();
                
                // Reset form dan editingId
                resetForm();
            }
        }
        
        // Fungsi untuk mengedit transaksi
        function editTransaksi(id) {
            const transaction = transactions.find(t => t.id === id);
            if (transaction) {
                editingId = id;
                
                // Isi form dengan data transaksi
                document.getElementById('tanggal').value = transaction.tanggal;
                document.getElementById('keterangan').value = transaction.keterangan;
                document.getElementById('tipe').value = transaction.tipe;
                
                // Format jumlah dengan separator ribuan
                document.getElementById('jumlah').value = new Intl.NumberFormat('id-ID').format(transaction.jumlah);
                
                // Scroll ke form
                document.getElementById('tanggal').scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        // Fungsi untuk menghapus transaksi
        function deleteTransaksi(id) {
            if (confirm('Apakah Anda yakin ingin menghapus transaksi ini?')) {
                transactions = transactions.filter(t => t.id !== id);
                
                // Simpan ke localStorage
                saveData();
                
                // Update tampilan
                updateTransactionTable();
                calculateTotals();
                
                // Reset form jika yang dihapus sedang diedit
                if (editingId === id) {
                    resetForm();
                }
            }
        }
        
        // Fungsi untuk menampilkan detail transaksi
        function showTransactionDetail(id) {
            const transaction = transactions.find(t => t.id === id);
            if (transaction) {
                const modal = document.getElementById('transactionModal');
                const detailDiv = document.getElementById('transactionDetail');
                
                // Format tanggal
                const date = new Date(transaction.tanggal);
                const formattedDate = date.toLocaleDateString('id-ID', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                // Buat konten detail
                detailDiv.innerHTML = `
                    <div style="margin-bottom: 15px;">
                        <strong>Tanggal:</strong> ${formattedDate}
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>Keterangan:</strong> ${transaction.keterangan}
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>Jenis:</strong> 
                        <span class="badge ${transaction.tipe === 'pemasukan' ? 'badge-income' : 'badge-expense'}">
                            ${transaction.tipe === 'pemasukan' ? 'Pemasukan' : 'Pengeluaran'}
                        </span>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>Jumlah:</strong> ${formatCurrency(transaction.jumlah)}
                    </div>
                    <div class="button-group" style="margin-top: 20px;">
                        <button class="btn btn-primary" onclick="editTransaksi(${transaction.id}); closeModal()">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-danger" onclick="deleteTransaksi(${transaction.id}); closeModal()">
                            <i class="icon-glass-red fas fa-trash"></i> Hapus
                        </button>
                    </div>
                `;
                
                // Tampilkan modal
                modal.style.display = 'flex';
            }
        }
        
        // Fungsi untuk menutup modal
        function closeModal() {
            document.getElementById('transactionModal').style.display = 'none';
        }
        
        // Fungsi untuk mereset form
        function resetForm() {
            editingId = null;
            document.getElementById('tanggal').valueAsDate = new Date();
            document.getElementById('keterangan').value = '';
            document.getElementById('tipe').value = 'pemasukan';
            document.getElementById('jumlah').value = '';
        }
        
        // Fungsi untuk menghapus semua data
        function clearData() {
            if (confirm('Apakah Anda yakin ingin menghapus SEMUA data transaksi? Aksi ini tidak dapat dibatalkan!')) {
                transactions = [];
                saveData();
                updateTransactionTable();
                calculateTotals();
                resetForm();
            }
        }
        
        // Fungsi untuk menyimpan data ke localStorage
        function saveData() {
            localStorage.setItem('financialTransactions', JSON.stringify(transactions));
        }
        
        function updateTransactionTable(filteredTransactions = null) {
    const tbody = document.getElementById('data-keuangan');
    tbody.innerHTML = '';
    
    const dataToDisplay = filteredTransactions || transactions;
    
    // Urutkan dari terlama ke terbaru (ascending)
    const sortedTransactions = [...dataToDisplay].sort((a, b) => {
        return new Date(a.tanggal) - new Date(b.tanggal);
    });
    
    // Hitung saldo berjalan
    let runningBalance = 0;
    const transactionsWithBalance = sortedTransactions.map(transaction => {
        if (transaction.tipe === 'pemasukan') {
            runningBalance += transaction.jumlah;
        } else {
            runningBalance -= transaction.jumlah;
        }
        return { ...transaction, saldo: runningBalance };
    });
    
    // Isi tabel
    transactionsWithBalance.forEach(transaction => {
        const row = document.createElement('tr');
        row.onclick = () => showTransactionDetail(transaction.id);
        row.style.cursor = 'pointer';
        
        // Format tanggal
        const date = new Date(transaction.tanggal);
        const formattedDate = date.toLocaleDateString('id-ID', {
            day: '2-digit',
            month: '2-digit',
            year: 'numeric'
        });
        
        // Tampilkan jumlah berdasarkan jenis transaksi
        const pemasukan = transaction.tipe === 'pemasukan' ? formatCurrency(transaction.jumlah) : '-';
        const pengeluaran = transaction.tipe === 'pengeluaran' ? formatCurrency(transaction.jumlah) : '-';
        
        row.innerHTML = `
            <td>${formattedDate}</td>
            <td>${transaction.keterangan}</td>
            <td class="currency" style="color: var(--primary-dark); font-weight: 500;">${pemasukan}</td>
            <td class="currency" style="color: var(--danger); font-weight: 500;">${pengeluaran}</td>
            <td class="currency" style="font-weight: 600;">${formatCurrency(transaction.saldo)}</td>
            <td class="action-buttons">
                <button class="btn-icon btn-edit" onclick="event.stopPropagation(); editTransaksi(${transaction.id})">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="btn-icon btn-delete" onclick="event.stopPropagation(); deleteTransaksi(${transaction.id})">
                    <i class="icon-glass-red fas fa-trash"></i>
                </button>
            </td>
        `;
        
        tbody.appendChild(row);
    });
}
        
        // Fungsi untuk menghitung total pemasukan, pengeluaran, dan saldo
        function calculateTotals() {
            calculateFilteredTotals(transactions);
            let totalPemasukan = 0;
            let totalPengeluaran = 0;
            
            transactions.forEach(transaction => {
                if (transaction.tipe === 'pemasukan') {
                    totalPemasukan += transaction.jumlah;
                } else {
                    totalPengeluaran += transaction.jumlah;
                }
            });
            
            const saldoAkhir = totalPemasukan - totalPengeluaran;
            
            // Update tampilan
            document.getElementById('totalPemasukan').textContent = formatCurrency(totalPemasukan);
            document.getElementById('totalPengeluaran').textContent = formatCurrency(totalPengeluaran);
            document.getElementById('saldoAkhir').textContent = formatCurrency(saldoAkhir);
        }
        
        // Fungsi untuk memfilter data berdasarkan tanggal
        function filterData() {
            const dateFilter = document.getElementById('searchDate').value;
            
            if (!dateFilter) {
                updateTransactionTable();
                return;
            }
            
            const filteredTransactions = transactions.filter(transaction => {
                return transaction.tanggal === dateFilter;
            });
            
            updateTransactionTable(filteredTransactions);
        }
        
        // Fungsi untuk mencari transaksi berdasarkan kata kunci
        function searchTransaction() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            if (!searchTerm) {
                updateTransactionTable();
                return;
            }
            
            const filteredTransactions = transactions.filter(transaction => {
                return (
                    transaction.keterangan.toLowerCase().includes(searchTerm) ||
                    transaction.jumlah.toString().includes(searchTerm) ||
                    transaction.tanggal.includes(searchTerm)
                );
            });
            
            updateTransactionTable(filteredTransactions);
        }
        
        // Fungsi untuk mengubah angka menjadi format mata uang tanpa desimal
        function formatCurrency(amount) {
            return 'Rp ' + Math.round(amount).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }
        
        // Fungsi untuk toggle settings panel
        function toggleSettings() {
            document.getElementById('settingsPanel').classList.toggle('active');
        }
        
        // Fungsi untuk menyimpan judul aplikasi
        function saveTitle() {
            const newTitle = document.getElementById('customTitle').value.trim();
            if (newTitle) {
                document.getElementById('laporanTitle').textContent = newTitle;
                localStorage.setItem('appTitle', newTitle);
                document.getElementById('settingsPanel').classList.remove('active');
                document.getElementById('customTitle').value = '';
            }
        }
        
        // Fungsi untuk membuka tab
        function openTab(tabName) {
            // Sembunyikan semua tab content
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            
            // Nonaktifkan semua tab
            const tabs = document.querySelectorAll('.tabs .tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Aktifkan tab yang dipilih
            document.getElementById(tabName).classList.add('active');
            
            // Temukan tab yang sesuai dan aktifkan
            const tabButtons = document.querySelectorAll('.tabs .tab');
            tabButtons.forEach(tab => {
                if (tab.getAttribute('onclick').includes(tabName)) {
                    tab.classList.add('active');
                }
            });
            
            // Jika membuka tab laporan, generate laporan terbaru
            if (tabName === 'laporan') {
                generateMonthlyReport();
            }
        }
        
        // Fungsi untuk membuka tab laporan
        function openReportTab(reportTabName) {
            // Sembunyikan semua tab content
            const reportTabContents = document.querySelectorAll('#laporan .tab-content');
            reportTabContents.forEach(tab => tab.classList.remove('active'));
            
            // Nonaktifkan semua tab
            const reportTabs = document.querySelectorAll('#laporan .tabs .tab');
            reportTabs.forEach(tab => tab.classList.remove('active'));
            
            // Aktifkan tab yang dipilih
            document.getElementById(reportTabName).classList.add('active');
            
            // Temukan tab yang sesuai dan aktifkan
            reportTabs.forEach(tab => {
                if (tab.getAttribute('onclick').includes(reportTabName)) {
                    tab.classList.add('active');
                }
            });
            
            // Generate laporan yang sesuai
            if (reportTabName === 'bulanan') {
                generateMonthlyReport();
            } else if (reportTabName === 'tahunan') {
                generateAnnualReport();
            }
        }
        
        // Fungsi untuk menghasilkan laporan bulanan
        function generateMonthlyReport() {
            const month = document.getElementById('reportMonth').value;
            const year = document.getElementById('reportMonthYear').value;
            
            // Filter transaksi berdasarkan bulan dan tahun
            const filteredTransactions = transactions.filter(transaction => {
                const [tYear, tMonth] = transaction.tanggal.split('-');
                return tYear === year && tMonth === month;
            });
            
            // Hitung total pemasukan dan pengeluaran
            let totalIncome = 0;
            let totalExpense = 0;
            
            filteredTransactions.forEach(transaction => {
                if (transaction.tipe === 'pemasukan') {
                    totalIncome += transaction.jumlah;
                } else {
                    totalExpense += transaction.jumlah;
                }
            });
            
            const balance = totalIncome - totalExpense;
            
            // Update ringkasan
            document.getElementById('monthlyIncome').textContent = formatCurrency(totalIncome);
            document.getElementById('monthlyExpense').textContent = formatCurrency(totalExpense);
            document.getElementById('monthlyBalance').textContent = formatCurrency(balance);
            
            // Tampilkan ringkasan bulanan
            updateMonthlySummary(month, year, totalIncome, totalExpense, balance);
            
            // Tampilkan semua transaksi bulanan
            showMonthlyTransactions(filteredTransactions);
            
            // Buat chart bulanan
            createMonthlyChart(filteredTransactions);
        }
        
        function updateMonthlySummary(month, year, totalIncome, totalExpense, balance) {
            const monthNames = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 
                               'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
            
            const monthlySummaryTbody = document.getElementById('monthlySummary');
            monthlySummaryTbody.innerHTML = '';
            
            const row = document.createElement('tr');
            const monthName = monthNames[parseInt(month) - 1];
            
            row.innerHTML = `
                <td>${monthName} ${year}</td>
                <td style="color: var(--primary-dark);">${formatCurrency(totalIncome)}</td>
                <td style="color: var(--danger);">${formatCurrency(totalExpense)}</td>
                <td style="font-weight: 600;">${formatCurrency(balance)}</td>
            `;
            
            monthlySummaryTbody.appendChild(row);
        }
        
        function showMonthlyTransactions(transactions) {
    const monthTbody = document.getElementById('monthlyTransactions');
    monthTbody.innerHTML = '';
    
    if (transactions.length === 0) {
        const row = document.createElement('tr');
        row.innerHTML = '<td colspan="5" style="text-align: center;">Tidak ada transaksi untuk bulan ini</td>';
        monthTbody.appendChild(row);
        return;
    }
    
    // Urutkan dari terlama ke terbaru (ascending)
    const sortedTransactions = [...transactions].sort((a, b) => {
        return new Date(a.tanggal) - new Date(b.tanggal);
    });
    
    // Hitung saldo berjalan
    let runningBalance = 0;
    const transactionsWithBalance = sortedTransactions.map(transaction => {
        if (transaction.tipe === 'pemasukan') {
            runningBalance += transaction.jumlah;
        } else {
            runningBalance -= transaction.jumlah;
        }
        return { ...transaction, saldo: runningBalance };
    });
    
    // Tampilkan transaksi
    transactionsWithBalance.forEach(transaction => {
        const row = document.createElement('tr');
        const date = new Date(transaction.tanggal);
        const formattedDate = date.toLocaleDateString('id-ID', {
            day: '2-digit',
            month: 'short',
            year: 'numeric'
        });
        
        // Format kolom pemasukan dan pengeluaran
        const pemasukan = transaction.tipe === 'pemasukan' ? formatCurrency(transaction.jumlah) : '-';
        const pengeluaran = transaction.tipe === 'pengeluaran' ? formatCurrency(transaction.jumlah) : '-';
        
        row.innerHTML = `
            <td>${formattedDate}</td>
            <td>${transaction.keterangan}</td>
            <td style="color: var(--primary-dark); font-weight: 500;">${pemasukan}</td>
            <td style="color: var(--danger); font-weight: 500;">${pengeluaran}</td>
            <td style="font-weight: 600;">${formatCurrency(transaction.saldo)}</td>
        `;
        
        monthTbody.appendChild(row);
    });
}
        
        function createMonthlyChart(transactions) {
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            
            // Kelompokkan transaksi per hari
            const dailyData = {};
            
            transactions.forEach(transaction => {
                const date = transaction.tanggal.split('-')[2]; // Ambil tanggal saja
                if (!dailyData[date]) {
                    dailyData[date] = { income: 0, expense: 0 };
                }
                
                if (transaction.tipe === 'pemasukan') {
                    dailyData[date].income += transaction.jumlah;
                } else {
                    dailyData[date].expense += transaction.jumlah;
                }
            });
            
            // Siapkan data untuk chart
            const labels = Object.keys(dailyData).sort();
            const incomeData = [];
            const expenseData = [];
            
            labels.forEach(date => {
                incomeData.push(dailyData[date].income);
                expenseData.push(dailyData[date].expense);
            });
            
            // Hancurkan chart sebelumnya jika ada
            if (monthlyChart) {
                monthlyChart.destroy();
            }
            // Warna grid & tick adaptif berdasar tema
            const isDark = document.body.classList.contains('theme-aurora');
            const gridColor = isDark ? 'rgba(233,249,247,0.18)' : 'rgba(0,0,0,0.08)';
            const tickColor = isDark ? 'rgba(233,249,247,0.9)' : '#6c757d';

            
            // Buat chart baru
            monthlyChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Pemasukan',
                            data: incomeData,
                            backgroundColor: 'rgba(76, 175, 80, 0.7)',
                            borderColor: 'rgba(76, 175, 80, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Pengeluaran',
                            data: expenseData,
                            backgroundColor: 'rgba(244, 67, 54, 0.7)',
                            borderColor: 'rgba(244, 67, 54, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                
options: {
    responsive: true,
    maintainAspectRatio: false,
    interaction: { mode: 'index', intersect: false },
    scales: {
        x: {
            grid: { color: gridColor, drawBorder: false, tickLength: 0 },
            ticks: { color: tickColor, autoSkip: true, maxTicksLimit: 12 }
        },
        y: {
            beginAtZero: true,
            grid: { color: gridColor, drawBorder: false },
            ticks: {
                color: tickColor,
                callback: (v) => 'Rp ' + Math.round(v).toLocaleString('id-ID')
            }
        }
    },
    plugins: {
        legend: { labels: { color: tickColor } },
        tooltip: {
            callbacks: {
                label: function (context) {
                    let label = context.dataset.label || '';
                    if (label) label += ': ';
                    return label + 'Rp ' + Number(context.raw).toLocaleString('id-ID');
                }
            }
        }
    }
}
            });
        }
        
        // Fungsi untuk menghasilkan laporan tahunan
        function generateAnnualReport() {
            const year = document.getElementById('filterYearAnnual').value;
            
            // Filter transaksi berdasarkan tahun
            const filteredTransactions = transactions.filter(transaction => {
                const [tYear] = transaction.tanggal.split('-');
                return tYear === year;
            });
            
            // Hitung total pemasukan dan pengeluaran
            let totalIncome = 0;
            let totalExpense = 0;
            
            filteredTransactions.forEach(transaction => {
                if (transaction.tipe === 'pemasukan') {
                    totalIncome += transaction.jumlah;
                } else {
                    totalExpense += transaction.jumlah;
                }
            });
            
            const balance = totalIncome - totalExpense;
            
            // Update ringkasan
            document.getElementById('annualIncome').textContent = formatCurrency(totalIncome);
            document.getElementById('annualExpense').textContent = formatCurrency(totalExpense);
            document.getElementById('annualBalance').textContent = formatCurrency(balance);
            
            // Buat ringkasan bulanan
            const monthlySummary = {};
            filteredTransactions.forEach(transaction => {
                const month = transaction.tanggal.split('-')[1];
                if (!monthlySummary[month]) {
                    monthlySummary[month] = {
                        income: 0,
                        expense: 0
                    };
                }
                
                if (transaction.tipe === 'pemasukan') {
                    monthlySummary[month].income += transaction.jumlah;
                } else {
                    monthlySummary[month].expense += transaction.jumlah;
                }
            });
            
            // Tampilkan ringkasan bulanan
            const monthlySummaryTbody = document.getElementById('annualMonthlySummary');
            monthlySummaryTbody.innerHTML = '';
            
            const monthNames = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 
                               'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
            
            for (let month = 1; month <= 12; month++) {
                const monthKey = month.toString().padStart(2, '0');
                const monthData = monthlySummary[monthKey] || { income: 0, expense: 0 };
                const monthBalance = monthData.income - monthData.expense;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${monthNames[month - 1]}</td>
                    <td style="color: var(--primary-dark);">${formatCurrency(monthData.income)}</td>
                    <td style="color: var(--danger);">${formatCurrency(monthData.expense)}</td>
                    <td style="font-weight: 600;">${formatCurrency(monthBalance)}</td>
                `;
                
                monthlySummaryTbody.appendChild(row);
            }
            
            // Buat chart tahunan
            createAnnualChart(monthlySummary);
            
            // Buat chart kategori pengeluaran
            createCategoryChart(filteredTransactions);
        }
        
        // Fungsi untuk membuat chart tahunan
        function createAnnualChart(monthlySummary) {
            const ctx = document.getElementById('annualChart').getContext('2d');
            
            // Siapkan data untuk chart
            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 
                               'Jul', 'Ags', 'Sep', 'Okt', 'Nov', 'Des'];
            const incomeData = [];
            const expenseData = [];
            
            for (let month = 1; month <= 12; month++) {
                const monthKey = month.toString().padStart(2, '0');
                const monthData = monthlySummary[monthKey] || { income: 0, expense: 0 };
                incomeData.push(monthData.income);
                expenseData.push(monthData.expense);
            }
            
            // Hancurkan chart sebelumnya jika ada
            if (annualChart) {
                annualChart.destroy();
            }
            // Warna grid & tick adaptif berdasar tema
            const isDark = document.body.classList.contains('theme-aurora');
            const gridColor = isDark ? 'rgba(233,249,247,0.18)' : 'rgba(0,0,0,0.08)';
            const tickColor = isDark ? 'rgba(233,249,247,0.9)' : '#6c757d';

            
            // Buat chart baru
            annualChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: monthNames,
                    datasets: [
                        {
                            label: 'Pemasukan',
                            data: incomeData,
                            backgroundColor: 'rgba(76, 175, 80, 0.2)',
                            borderColor: 'rgba(76, 175, 80, 1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Pengeluaran',
                            data: expenseData,
                            backgroundColor: 'rgba(244, 67, 54, 0.2)',
                            borderColor: 'rgba(244, 67, 54, 1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                
options: {
    responsive: true,
    maintainAspectRatio: false,
    interaction: { mode: 'index', intersect: false },
    scales: {
        x: {
            grid: { color: gridColor, drawBorder: false, tickLength: 0 },
            ticks: { color: tickColor, autoSkip: true, maxTicksLimit: 12 }
        },
        y: {
            beginAtZero: true,
            grid: { color: gridColor, drawBorder: false },
            ticks: {
                color: tickColor,
                callback: (v) => 'Rp ' + Math.round(v).toLocaleString('id-ID')
            }
        }
    },
    plugins: {
        legend: { labels: { color: tickColor } },
        tooltip: {
            callbacks: {
                label: function (context) {
                    let label = context.dataset.label || '';
                    if (label) label += ': ';
                    return label + 'Rp ' + Number(context.raw).toLocaleString('id-ID');
                }
            }
        }
    }
}
            });
        }
        
        // Fungsi untuk membuat chart kategori pengeluaran
        function createCategoryChart(transactions) {
            const ctx = document.getElementById('categoryChart').getContext('2d');
            
            // Kategorikan pengeluaran berdasarkan keyword dalam keterangan
            const categories = {
                'Makanan': ['makan', 'restoran', 'warung', 'kafe', 'minum', 'kopi', 'nasi'],
                'Transportasi': ['transport', 'bensin', 'ojol', 'taksi', 'angkot', 'bus', 'kereta'],
                'Belanja': ['belanja', 'mall', 'supermarket', 'pasar', 'baju', 'celana', 'sepatu'],
                'Hiburan': ['hiburan', 'nonton', 'film', 'konser', 'game', 'hobi'],
                'Tagihan': ['listrik', 'air', 'internet', 'pulsa', 'tv', 'kabel', 'asuransi'],
                'Lainnya': [] // Default category
            };
            
            const categoryTotals = {};
            Object.keys(categories).forEach(cat => {
                categoryTotals[cat] = 0;
            });
            
            // Hitung total pengeluaran per kategori
            transactions.forEach(transaction => {
                if (transaction.tipe === 'pengeluaran') {
                    let categorized = false;
                    const desc = transaction.keterangan.toLowerCase();
                    
                    for (const [category, keywords] of Object.entries(categories)) {
                        if (keywords.some(keyword => desc.includes(keyword))) {
                            categoryTotals[category] += transaction.jumlah;
                            categorized = true;
                            break;
                        }
                    }
                    
                    if (!categorized) {
                        categoryTotals['Lainnya'] += transaction.jumlah;
                    }
                }
            });
            
            // Siapkan data untuk chart (hanya kategori dengan nilai > 0)
            const labels = [];
            const data = [];
            const backgroundColors = [
                'rgba(255, 99, 132, 0.7)',
                'rgba(54, 162, 235, 0.7)',
                'rgba(255, 206, 86, 0.7)',
                'rgba(75, 192, 192, 0.7)',
                'rgba(153, 102, 255, 0.7)',
                'rgba(255, 159, 64, 0.7)'
            ];
            const borderColors = [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ];
            
            let colorIndex = 0;
            for (const [category, total] of Object.entries(categoryTotals)) {
                if (total > 0) {
                    labels.push(category);
                    data.push(total);
                    colorIndex = (colorIndex + 1) % backgroundColors.length;
                }
            }
            
            // Hancurkan chart sebelumnya jika ada
            if (categoryChart) {
                categoryChart.destroy();
            }
            
            // Buat chart baru jika ada data
            if (data.length > 0) {
                categoryChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: data,
                            backgroundColor: backgroundColors.slice(0, labels.length),
                            borderColor: borderColors.slice(0, labels.length),
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const label = context.label || '';
                                        const value = context.raw || 0;
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = Math.round((value / total) * 100);
                                        return `${label}: Rp ${value.toLocaleString()} (${percentage}%)`;
                                    }
                                }
                            },
                            legend: {
                                position: 'right',
                            }
                        }
                    }
                });
            } else {
                // Jika tidak ada data pengeluaran, tampilkan pesan
                ctx.font = '16px Poppins';
                ctx.fillStyle = '#666';
                ctx.textAlign = 'center';
                ctx.fillText('Tidak ada data pengeluaran', ctx.canvas.width / 2, ctx.canvas.height / 2);
            }
        }
        
        // Fungsi untuk menyimpan laporan ke PDF
        function simpanPDF() {
    const doc = new jsPDF({
        orientation: window.innerWidth < 768 ? 'portrait' : 'potrait'
    });

    // Dapatkan judul dari pengaturan
    const appTitle = getAppTitle();

    // Judul laporan
    doc.setFontSize(16);
    doc.setTextColor(46, 125, 50);
    doc.text(appTitle.toUpperCase(), doc.internal.pageSize.width / 2, 15, { align: 'center' });

    // Tanggal cetak
    doc.setFontSize(10);
    doc.setTextColor(100, 100, 100);
    const today = new Date();
    doc.text(`Dicetak pada: ${today.toLocaleDateString('id-ID')} ${today.toLocaleTimeString('id-ID')}`, 
             doc.internal.pageSize.width / 2, 22, { align: 'center' });

    // Ringkasan keuangan
    doc.setFontSize(12);
    doc.setTextColor(33, 37, 41);
    doc.text('Ringkasan Keuangan', 14, 30);
    doc.setDrawColor(76, 175, 80);
    doc.setLineWidth(0.3);
    doc.line(14, 32, 50, 32);

    // Data ringkasan
    doc.setFontSize(10);
    doc.text(`Total Pemasukan: ${document.getElementById('totalPemasukan').textContent}`, 14, 38);
    doc.text(`Total Pengeluaran: ${document.getElementById('totalPengeluaran').textContent}`, 14, 44);
    doc.text(`Saldo Akhir: ${document.getElementById('saldoAkhir').textContent}`, 14, 50);

    // Data transaksi
    doc.setFontSize(12);
    doc.text('Daftar Transaksi', 14, 60);
    doc.line(14, 62, 45, 62);

    // Buat tabel transaksi dengan pengaturan kolom responsif
    const isMobile = window.innerWidth < 768;
    const columnStyles = isMobile ? {
        0: { cellWidth: 15 },
        1: { cellWidth: 40 },
        2: { cellWidth: 25 },
        3: { cellWidth: 25 },
        4: { cellWidth: 25 }
    } : {
        0: { cellWidth: 20 },
        1: { cellWidth: 60 },
        2: { cellWidth: 30 },
        3: { cellWidth: 30 },
        4: { cellWidth: 30 }
    };

    const headers = [['Tanggal', 'Keterangan', 'Pemasukan', 'Pengeluaran', 'Saldo']];
    const data = [];

    const rows = document.querySelectorAll('#laporanTable tbody tr');
    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        data.push([
            cells[0].textContent,
            cells[1].textContent,
            cells[2].textContent,
            cells[3].textContent,
            cells[4].textContent
        ]);
    });

    // Tambahkan tabel ke PDF
    doc.autoTable({
        startY: 65,
        head: headers,
        body: data,
        headStyles: {
            fillColor: [76, 175, 80],
            textColor: [255, 255, 255],
            fontSize: isMobile ? 8 : 9,
            cellPadding: 2
        },
        bodyStyles: {
            fontSize: isMobile ? 7 : 8,
            cellPadding: 2
        },
        alternateRowStyles: {
            fillColor: [245, 245, 245]
        },
        styles: {
            overflow: 'linebreak',
            halign: 'left'
        },
        columnStyles: columnStyles,
        margin: { left: 10, right: 10 }
    });

    // Footer
    const pageCount = doc.internal.getNumberOfPages();
    for (let i = 1; i <= pageCount; i++) {
        doc.setPage(i);
        doc.setFontSize(8);
        doc.setTextColor(100, 100, 100);
        doc.text(`Halaman ${i} dari ${pageCount}`, 
                doc.internal.pageSize.width / 2, 
                doc.internal.pageSize.height - 10, 
                { align: 'center' });
    }

    // Simpan PDF
    doc.save(`Laporan Keuangan - ${today.toLocaleDateString('id-ID')}.pdf`);
}
        
      // Fungsi untuk mengekspor data ke Excel (diperbarui)
      function exportExcel() {
    // Siapkan data untuk workbook
    const wb = XLSX.utils.book_new();
    const title = getAppTitle();
    const today = new Date();
    
    // Data transaksi dengan format lengkap
    const transaksiData = [
        [title.toUpperCase()], // Judul dari pengaturan
        ['Dicetak pada: ' + today.toLocaleDateString('id-ID') + ' ' + today.toLocaleTimeString('id-ID')],
        [''],
        ['Ringkasan Keuangan'],
        ['Total Pemasukan', document.getElementById('totalPemasukan').textContent],
        ['Total Pengeluaran', document.getElementById('totalPengeluaran').textContent],
        ['Saldo Akhir', document.getElementById('saldoAkhir').textContent],
        [''],
        ['Daftar Transaksi'],
        ['No.', 'Tanggal', 'Keterangan', 'Pemasukan', 'Pengeluaran', 'Saldo'] // Header dengan nomor urut
    ];

    // Tambahkan data transaksi dengan nomor urut
    const rows = document.querySelectorAll('#laporanTable tbody tr');
    let rowNumber = 1;
    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        transaksiData.push([
            rowNumber++,
            cells[0].textContent,
            cells[1].textContent,
            cells[2].textContent,
            cells[3].textContent,
            cells[4].textContent
        ]);
    });

    // Buat worksheet
    const ws = XLSX.utils.aoa_to_sheet(transaksiData);
    
    // Atur lebar kolom
    ws['!cols'] = [
        {wch: 5},  // No.
        {wch: 12}, // Tanggal
        {wch: 40}, // Keterangan
        {wch: 15}, // Pemasukan
        {wch: 15}, // Pengeluaran
        {wch: 15}  // Saldo
    ];

    // Gabungkan sel untuk judul
    ws['!merges'] = [
        XLSX.utils.decode_range("A1:F1"), // Judul utama
        XLSX.utils.decode_range("A2:F2"), // Tanggal cetak
        XLSX.utils.decode_range("A4:F4"), // Header ringkasan
        XLSX.utils.decode_range("A8:F8")  // Header transaksi
    ];

    // Tambahkan border ke seluruh tabel
    const range = XLSX.utils.decode_range(ws['!ref']);
    for (let R = 8; R <= range.e.r; ++R) {
        for (let C = range.s.c; C <= range.e.c; ++C) {
            const cell_address = {c:C, r:R};
            const cell_ref = XLSX.utils.encode_cell(cell_address);
            
            if (!ws[cell_ref]) continue;
            
            // Set border style
            ws[cell_ref].s = {
                border: {
                    top: {style: "thin", color: {auto: 1}},
                    bottom: {style: "thin", color: {auto: 1}},
                    left: {style: "thin", color: {auto: 1}},
                    right: {style: "thin", color: {auto: 1}}
                }
            };
        }
    }

    // Style untuk header tabel
    for (let C = range.s.c; C <= range.e.c; ++C) {
        const cell_address = {c:C, r:8};
        const cell_ref = XLSX.utils.encode_cell(cell_address);
        
        if (!ws[cell_ref]) continue;
        
        ws[cell_ref].s = {
            font: {bold: true, color: {rgb: "FFFFFF"}},
            fill: {fgColor: {rgb: "4CAF50"}},
            alignment: {horizontal: "center"},
            border: {
                top: {style: "thin", color: {auto: 1}},
                bottom: {style: "thin", color: {auto: 1}},
                left: {style: "thin", color: {auto: 1}},
                right: {style: "thin", color: {auto: 1}}
            }
        };
    }

    // Tambahkan worksheet ke workbook
    XLSX.utils.book_append_sheet(wb, ws, 'Laporan Keuangan');
    
    // Simpan file
    XLSX.writeFile(wb, `${title} - ${today.toLocaleDateString('id-ID')}.xlsx`);
}

        
        // Fungsi untuk export laporan bulanan ke PDF
        function exportMonthlyPDF() {
    const doc = new jsPDF({
        orientation: window.innerWidth < 768 ? 'portrait' : 'potrait'
    });
    
    const appTitle = getAppTitle();
    const month = document.getElementById('reportMonth').value;
            const year = document.getElementById('reportMonthYear').value;
    const monthNames = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 
                       'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
    const monthName = monthNames[parseInt(month) - 1];
    
   // Judul laporan
   doc.setFontSize(16);
    doc.setTextColor(46, 125, 50);
    doc.text(`${appTitle.toUpperCase()} - BULAN ${monthName} ${year}`, doc.internal.pageSize.width / 2, 15, { align: 'center' });
    
    // Tanggal cetak
    doc.setFontSize(10);
    doc.setTextColor(100, 100, 100);
    const today = new Date();
    doc.text(`Dicetak pada: ${today.toLocaleDateString('id-ID')} ${today.toLocaleTimeString('id-ID')}`, 
             doc.internal.pageSize.width / 2, 22, { align: 'center' });
    
    // Ringkasan keuangan
    doc.setFontSize(12);
    doc.setTextColor(33, 37, 41);
    doc.text('Ringkasan Keuangan', 14, 30);
    doc.setDrawColor(76, 175, 80);
    doc.setLineWidth(0.3);
    doc.line(14, 32, 50, 32);
    
    // Data ringkasan
    doc.setFontSize(10);
    doc.text(`Total Pemasukan: ${document.getElementById('monthlyIncome').textContent}`, 14, 38);
    doc.text(`Total Pengeluaran: ${document.getElementById('monthlyExpense').textContent}`, 14, 44);
    doc.text(`Saldo: ${document.getElementById('monthlyBalance').textContent}`, 14, 50);
    
    // Transaksi bulanan
    doc.setFontSize(12);
    doc.text('Daftar Transaksi', 14, 60);
    doc.line(14, 62, 45, 62);
    
    // Buat tabel transaksi dengan pengaturan kolom responsif
    const isMobile = window.innerWidth < 768;
    const columnStyles = isMobile ? {
        0: { cellWidth: 15 },
        1: { cellWidth: 40 },
        2: { cellWidth: 25 },
        3: { cellWidth: 25 },
        4: { cellWidth: 25 }
    } : {
        0: { cellWidth: 20 },
        1: { cellWidth: 60 },
        2: { cellWidth: 30 },
        3: { cellWidth: 30 },
        4: { cellWidth: 30 }
    };
    
    const headers = [['Tanggal', 'Keterangan', 'Pemasukan', 'Pengeluaran', 'Saldo']];
    const data = [];
    
    const rows = document.querySelectorAll('#monthlyTransactionsTable tbody tr');
    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        data.push([
            cells[0].textContent,
            cells[1].textContent,
            cells[2].textContent,
            cells[3].textContent,
            cells[4].textContent
        ]);
    });
    
    // Tambahkan tabel ke PDF
    doc.autoTable({
        startY: 65,
        head: headers,
        body: data,
        headStyles: {
            fillColor: [76, 175, 80],
            textColor: [255, 255, 255],
            fontSize: isMobile ? 8 : 9,
            cellPadding: 2
        },
        bodyStyles: {
            fontSize: isMobile ? 7 : 8,
            cellPadding: 2
        },
        alternateRowStyles: {
            fillColor: [245, 245, 245]
        },
        styles: {
            overflow: 'linebreak',
            halign: 'left'
        },
        columnStyles: columnStyles,
        margin: { left: 10, right: 10 }
    });
    
    // Footer
    const pageCount = doc.internal.getNumberOfPages();
    for (let i = 1; i <= pageCount; i++) {
        doc.setPage(i);
        doc.setFontSize(8);
        doc.setTextColor(100, 100, 100);
        doc.text(`Halaman ${i} dari ${pageCount}`, 
                doc.internal.pageSize.width / 2, 
                doc.internal.pageSize.height - 10, 
                { align: 'center' });
    }
    
    // Simpan PDF
    doc.save(`Laporan Bulanan ${monthName} ${year}.pdf`);
}
        
       // Fungsi untuk export laporan bulanan ke Excel (diperbarui)
       function exportMonthlyExcel() {
    const month = document.getElementById('reportMonth').value;
    const year = document.getElementById('reportMonthYear').value;
    const monthNames = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 
                       'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
    const monthName = monthNames[parseInt(month) - 1];
    const title = getAppTitle();
    const today = new Date();

    // Siapkan data untuk workbook
    const wb = XLSX.utils.book_new();
    
    // Data dengan format lengkap
    const reportData = [
        [`${title.toUpperCase()} - BULAN ${monthName} ${year}`],
        ['Dicetak pada: ' + today.toLocaleDateString('id-ID') + ' ' + today.toLocaleTimeString('id-ID')],
        [''],
        ['Ringkasan Keuangan'],
        ['Total Pemasukan', document.getElementById('monthlyIncome').textContent],
        ['Total Pengeluaran', document.getElementById('monthlyExpense').textContent],
        ['Saldo', document.getElementById('monthlyBalance').textContent],
        [''],
        ['Ringkasan Bulanan'],
        ['Bulan', 'Pemasukan', 'Pengeluaran', 'Saldo'],
        [`${monthName} ${year}`, 
         document.getElementById('monthlyIncome').textContent, 
         document.getElementById('monthlyExpense').textContent, 
         document.getElementById('monthlyBalance').textContent],
        [''],
        ['Daftar Transaksi'],
        ['No.', 'Tanggal', 'Keterangan', 'Pemasukan', 'Pengeluaran', 'Saldo']
    ];
    
    // Tambahkan data transaksi bulanan dengan nomor urut
    const rows = document.querySelectorAll('#monthlyTransactionsTable tbody tr');
    let rowNumber = 1;
    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        reportData.push([
            rowNumber++,
            cells[0].textContent,
            cells[1].textContent,
            cells[2].textContent,
            cells[3].textContent,
            cells[4].textContent
        ]);
    });
    
    // Buat worksheet
    const ws = XLSX.utils.aoa_to_sheet(reportData);
    
    // Atur lebar kolom
    ws['!cols'] = [
        {wch: 5},  // No.
        {wch: 12}, // Tanggal
        {wch: 40}, // Keterangan
        {wch: 15}, // Pemasukan
        {wch: 15}, // Pengeluaran
        {wch: 15}  // Saldo
    ];

    // Gabungkan sel untuk judul dan header
    ws['!merges'] = [
        XLSX.utils.decode_range("A1:F1"),
        XLSX.utils.decode_range("A2:F2"),
        XLSX.utils.decode_range("A4:F4"),
        XLSX.utils.decode_range("A8:D8"),
        XLSX.utils.decode_range("A10:D10"),
        XLSX.utils.decode_range("A12:F12")
    ];

    // Tambahkan border ke seluruh tabel transaksi
    const range = XLSX.utils.decode_range(ws['!ref']);
    for (let R = 12; R <= range.e.r; ++R) {
        for (let C = range.s.c; C <= range.e.c; ++C) {
            const cell_address = {c:C, r:R};
            const cell_ref = XLSX.utils.encode_cell(cell_address);
            
            if (!ws[cell_ref]) continue;
            
            ws[cell_ref].s = {
                border: {
                    top: {style: "thin", color: {auto: 1}},
                    bottom: {style: "thin", color: {auto: 1}},
                    left: {style: "thin", color: {auto: 1}},
                    right: {style: "thin", color: {auto: 1}}
                }
            };
        }
    }

    // Style untuk header tabel transaksi
    for (let C = range.s.c; C <= range.e.c; ++C) {
        const cell_address = {c:C, r:12};
        const cell_ref = XLSX.utils.encode_cell(cell_address);
        
        if (!ws[cell_ref]) continue;
        
        ws[cell_ref].s = {
            font: {bold: true, color: {rgb: "FFFFFF"}},
            fill: {fgColor: {rgb: "4CAF50"}},
            alignment: {horizontal: "center"},
            border: {
                top: {style: "thin", color: {auto: 1}},
                bottom: {style: "thin", color: {auto: 1}},
                left: {style: "thin", color: {auto: 1}},
                right: {style: "thin", color: {auto: 1}}
            }
        };
    }

    // Tambahkan worksheet ke workbook
    XLSX.utils.book_append_sheet(wb, ws, `Laporan ${monthName}`);
    
    // Simpan file
    XLSX.writeFile(wb, `${title} - ${monthName} ${year}.xlsx`);
}

        
        // Fungsi untuk export laporan tahunan ke PDF
        function exportAnnualPDF() {
            const doc = new jsPDF();
            
            
            const appTitle = getAppTitle();
            const year = document.getElementById('filterYearAnnual').value;
            // Judul laporan
    doc.setFontSize(16);
    doc.setTextColor(46, 125, 50);
    doc.text(`${appTitle.toUpperCase()} - TAHUN ${year}`, doc.internal.pageSize.width / 2, 15, { align: 'center' });
            
            // Tanggal cetak
            doc.setFontSize(10);
            doc.setTextColor(100, 100, 100);
            const today = new Date();
            doc.text(`Dicetak pada: ${today.toLocaleDateString('id-ID')} ${today.toLocaleTimeString('id-ID')}`, 105, 28, { align: 'center' });
            
            // Ringkasan keuangan
            doc.setFontSize(14);
            doc.setTextColor(33, 37, 41);
            doc.text('Ringkasan Keuangan', 14, 40);
            doc.setDrawColor(76, 175, 80);
            doc.setLineWidth(0.5);
            doc.line(14, 42, 60, 42);
            
            // Data ringkasan
            doc.setFontSize(12);
            doc.text(`Total Pemasukan: ${document.getElementById('annualIncome').textContent}`, 14, 50);
            doc.text(`Total Pengeluaran: ${document.getElementById('annualExpense').textContent}`, 14, 58);
            doc.text(`Saldo: ${document.getElementById('annualBalance').textContent}`, 14, 66);
            
            // Ringkasan bulanan
            doc.setFontSize(14);
            doc.text('Ringkasan Bulanan', 14, 80);
            doc.line(14, 82, 60, 82);
            
            // Buat tabel ringkasan bulanan
            const summaryHeaders = [['Bulan', 'Pemasukan', 'Pengeluaran', 'Saldo']];
            const summaryData = [];
            
            const summaryRows = document.querySelectorAll('#annualMonthlySummaryTable tbody tr');
            summaryRows.forEach(row => {
                const cells = row.querySelectorAll('td');
                summaryData.push([
                    cells[0].textContent,
                    cells[1].textContent,
                    cells[2].textContent,
                    cells[3].textContent
                ]);
            });
            
            // Tambahkan tabel ke PDF
            doc.autoTable({
                startY: 85,
                head: summaryHeaders,
                body: summaryData,
                headStyles: {
                    fillColor: [76, 175, 80],
                    textColor: [255, 255, 255],
                    fontSize: 10
                },
                bodyStyles: {
                    fontSize: 9
                },
                alternateRowStyles: {
                    fillColor: [245, 245, 245]
                },
                styles: {
                    cellPadding: 3,
                    overflow: 'linebreak',
                    halign: 'left'
                },
                columnStyles: {
                    0: { cellWidth: 40 },
                    1: { cellWidth: 30 },
                    2: { cellWidth: 30 },
                    3: { cellWidth: 30 }
                }
            });
            
            // Footer
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(10);
                doc.setTextColor(100, 100, 100);
                doc.text(`Halaman ${i} dari ${pageCount}`, 105, 285, { align: 'center' });
            }
            
            // Simpan PDF
            doc.save(`Laporan Tahunan ${year}.pdf`);
        }
        
        // Fungsi untuk export laporan tahunan ke Excel
       // Fungsi untuk export laporan tahunan ke Excel (diperbarui)
// Fungsi untuk export laporan tahunan ke Excel dengan border
function exportAnnualExcel() {
    const year = document.getElementById('filterYearAnnual').value;
    const title = getAppTitle();
    const today = new Date();
    
    // Siapkan data untuk workbook
    const wb = XLSX.utils.book_new();
    
    // Data dengan format lengkap
    const reportData = [
        [`${title.toUpperCase()} - TAHUN ${year}`],
        ['Dicetak pada: ' + today.toLocaleDateString('id-ID') + ' ' + today.toLocaleTimeString('id-ID')],
        [''],
        ['Ringkasan Keuangan'],
        ['Total Pemasukan', document.getElementById('annualIncome').textContent],
        ['Total Pengeluaran', document.getElementById('annualExpense').textContent],
        ['Saldo', document.getElementById('annualBalance').textContent],
        [''],
        ['Ringkasan Bulanan'],
        ['No.', 'Bulan', 'Pemasukan', 'Pengeluaran', 'Saldo'] // Tambahkan nomor urut
    ];
    
    // Tambahkan data ringkasan bulanan dengan nomor urut
    const summaryRows = document.querySelectorAll('#annualMonthlySummaryTable tbody tr');
    let rowNumber = 1;
    summaryRows.forEach(row => {
        const cells = row.querySelectorAll('td');
        reportData.push([
            rowNumber++,
            cells[0].textContent,
            cells[1].textContent,
            cells[2].textContent,
            cells[3].textContent
        ]);
    });
    
    // Buat worksheet
    const ws = XLSX.utils.aoa_to_sheet(reportData);
    
    // Atur lebar kolom
    ws['!cols'] = [
        {wch: 5},  // No.
        {wch: 20}, // Bulan
        {wch: 15}, // Pemasukan
        {wch: 15}, // Pengeluaran
        {wch: 15}  // Saldo
    ];

    // Gabungkan sel untuk judul dan header
    ws['!merges'] = [
        XLSX.utils.decode_range("A1:E1"),
        XLSX.utils.decode_range("A2:E2"),
        XLSX.utils.decode_range("A4:E4"),
        XLSX.utils.decode_range("A8:E8")
    ];

    // Tambahkan border ke seluruh tabel ringkasan bulanan
    const range = XLSX.utils.decode_range(ws['!ref']);
    for (let R = 8; R <= range.e.r; ++R) {
        for (let C = range.s.c; C <= range.e.c; ++C) {
            const cell_address = {c:C, r:R};
            const cell_ref = XLSX.utils.encode_cell(cell_address);
            
            if (!ws[cell_ref]) continue;
            
            ws[cell_ref].s = {
                border: {
                    top: {style: "thin", color: {auto: 1}},
                    bottom: {style: "thin", color: {auto: 1}},
                    left: {style: "thin", color: {auto: 1}},
                    right: {style: "thin", color: {auto: 1}}
                }
            };
        }
    }

    // Style untuk header tabel ringkasan
    for (let C = range.s.c; C <= range.e.c; ++C) {
        const cell_address = {c:C, r:8};
        const cell_ref = XLSX.utils.encode_cell(cell_address);
        
        if (!ws[cell_ref]) continue;
        
        ws[cell_ref].s = {
            font: {bold: true, color: {rgb: "FFFFFF"}},
            fill: {fgColor: {rgb: "4CAF50"}},
            alignment: {horizontal: "center"},
            border: {
                top: {style: "thin", color: {auto: 1}},
                bottom: {style: "thin", color: {auto: 1}},
                left: {style: "thin", color: {auto: 1}},
                right: {style: "thin", color: {auto: 1}}
            }
        };
    }

    // Tambahkan worksheet ke workbook
    XLSX.utils.book_append_sheet(wb, ws, `Laporan ${year}`);
    
    // Simpan file
    XLSX.writeFile(wb, `${title} - Tahun ${year}.xlsx`);
}
        
        // Event listener untuk menutup modal ketika klik di luar modal
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('transactionModal');
            if (event.target === modal) {
                closeModal();
            }
        });
        
        // Event listener untuk currency formatting
        document.querySelectorAll('.currency').forEach(element => {
            const value = parseFloat(element.textContent.replace(/[^0-9.-]+/g,"")) || 0;
            element.textContent = formatCurrency(value);
        });

        // Fungsi untuk mengkonversi chart ke gambar base64
async function chartToBase64(chartId) {
    const chartCanvas = document.getElementById(chartId);
    if (!chartCanvas) return null;
    
    // Clone canvas untuk menghindari masalah ukuran
    const clonedCanvas = document.createElement('canvas');
    const originalCanvas = chartCanvas;
    
    // Set ukuran yang sesuai
    clonedCanvas.width = originalCanvas.width;
    clonedCanvas.height = originalCanvas.height;
    
    const ctx = clonedCanvas.getContext('2d');
    ctx.fillStyle = 'white';
    ctx.fillRect(0, 0, clonedCanvas.width, clonedCanvas.height);
    ctx.drawImage(originalCanvas, 0, 0);
    
    return clonedCanvas.toDataURL('image/png');
}

// Inisialisasi tahun untuk filter
function initYearFilter() {
            const yearSelect = document.getElementById('filterYear');
            const currentYear = new Date().getFullYear();
            
            yearSelect.innerHTML = '';
            for (let year = currentYear - 5; year <= currentYear + 1; year++) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                if (year === currentYear) {
                    option.selected = true;
                }
                yearSelect.appendChild(option);
            }
        }

// Fungsi untuk mengubah tampilan filter berdasarkan jenis yang dipilih
function changeFilterType() {
    const filterType = document.getElementById('filterType').value;
    
    // Sembunyikan semua kontrol filter
    document.querySelectorAll('.filter-control').forEach(control => {
        control.style.display = 'none';
    });
    
    // Tampilkan kontrol yang sesuai
    if (filterType === 'date') {
        document.getElementById('dateFilterControl').style.display = 'block';
        // Set tanggal default ke hari ini
        document.getElementById('filterDate').valueAsDate = new Date();
    } else if (filterType === 'month') {
        document.getElementById('monthFilterControl').style.display = 'block';
        // Set bulan dan tahun default
        const today = new Date();
        document.getElementById('filterMonth').value = (today.getMonth() + 1).toString().padStart(2, '0');
        fillYearDropdowns(); // Panggil fungsi untuk mengisi tahun
    } else if (filterType === 'range') {
        document.getElementById('rangeFilterControl').style.display = 'block';
        // Set rentang default 1 bulan terakhir
        const endDate = new Date();
        const startDate = new Date();
        startDate.setMonth(endDate.getMonth() - 1);
        
        document.getElementById('filterStartDate').valueAsDate = startDate;
        document.getElementById('filterEndDate').valueAsDate = endDate;
    }
    
    // Terapkan filter
    filterTransactions();
}
// Fungsi utama untuk memfilter transaksi

function filterTransactions() {
    const filterType = document.getElementById('filterType').value;
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    let filteredTransactions = [...transactions];
    
    // Filter berdasarkan jenis filter
    if (filterType === 'date') {
        const selectedDate = document.getElementById('filterDate').value;
        if (selectedDate) {
            filteredTransactions = filteredTransactions.filter(t => t.tanggal === selectedDate);
        }
    } else if (filterType === 'month') {
        const month = document.getElementById('filterMonth').value;
        const year = document.getElementById('filterYear').value;
        
        if (month && year) {
            filteredTransactions = filteredTransactions.filter(t => {
                const [tYear, tMonth] = t.tanggal.split('-');
                return tYear === year && tMonth === month;
            });
        }
    } else if (filterType === 'range') {
        const startDate = document.getElementById('filterStartDate').value;
        const endDate = document.getElementById('filterEndDate').value;
        
        if (startDate && endDate) {
            filteredTransactions = filteredTransactions.filter(t => {
                return t.tanggal >= startDate && t.tanggal <= endDate;
            });
        }
    }
    
    // Filter berdasarkan pencarian teks
    if (searchTerm) {
        filteredTransactions = filteredTransactions.filter(t => {
            return (
                t.keterangan.toLowerCase().includes(searchTerm) ||
                t.jumlah.toString().includes(searchTerm) ||
                t.tanggal.includes(searchTerm) ||
                (t.tipe === 'pemasukan' ? 'pemasukan' : 'pengeluaran').includes(searchTerm)
            );
        });
    }
    
    // Update tabel dengan transaksi yang sudah difilter
    updateTransactionTable(filteredTransactions);
    
    // Hitung total berdasarkan filter
    calculateFilteredTotals(filteredTransactions);
}

// Panggil fungsi inisialisasi saat halaman dimuat
window.addEventListener('DOMContentLoaded', () => {
    initYearFilter();
    changeFilterType(); // Set filter default
});

function getAppTitle() {
    const savedTitle = localStorage.getItem('appTitle');
    return savedTitle || 'LAPORAN KEUANGAN HARIAN'; // Default title jika belum diatur
}

function initReportYearFilter() {
    const yearSelect = document.getElementById('reportMonthYear');
    const currentYear = new Date().getFullYear();
    
    yearSelect.innerHTML = '';
    for (let year = currentYear - 5; year <= 2030; year++) {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year;
        if (year === currentYear) {
            option.selected = true;
        }
        yearSelect.appendChild(option);
    }
}

// Fungsi untuk inisialisasi filter tahun laporan tahunan (hingga 2030)
function initAnnualYearFilter() {
    const yearSelect = document.getElementById('filterYearAnnual');
    const currentYear = new Date().getFullYear();
    
    yearSelect.innerHTML = '';
    for (let year = currentYear - 5; year <= 2030; year++) {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year;
        if (year === currentYear) {
            option.selected = true;
        }
        yearSelect.appendChild(option);
    }
}

        function calculateFilteredTotals(filteredTransactions) {
    let totalPemasukan = 0;
    let totalPengeluaran = 0;
    
    filteredTransactions.forEach(transaction => {
        if (transaction.tipe === 'pemasukan') {
            totalPemasukan += transaction.jumlah;
        } else {
            totalPengeluaran += transaction.jumlah;
        }
    });
    
    const saldoAkhir = totalPemasukan - totalPengeluaran;
    
    // Update tampilan dashboard
    document.getElementById('totalPemasukan').textContent = formatCurrency(totalPemasukan);
    document.getElementById('totalPengeluaran').textContent = formatCurrency(totalPengeluaran);
    document.getElementById('saldoAkhir').textContent = formatCurrency(saldoAkhir);
}
    </script>

<script>
  (function(){
    const THEME_KEY = 'budgeting_theme';
    const body = document.body;
    const select = document.getElementById('themeSelect');

    function applyTheme(theme){
      if(theme === 'aurora'){
        body.classList.add('theme-aurora');
      }else{
        body.classList.remove('theme-aurora');
      }
    }

    // Load saved theme
    const saved = localStorage.getItem(THEME_KEY) || 'light';
    applyTheme(saved);
    if(select){ select.value = saved; }

    // Listen for changes
    if(select){
      select.addEventListener('change', function(){
        const val = this.value;
        applyTheme(val);
        localStorage.setItem(THEME_KEY, val);
      });
    }

    // Optional: expose for manual toggle
    window.setTheme = function(v){ applyTheme(v); localStorage.setItem(THEME_KEY, v); };
  })();
</script>


<!-- ====== PATCH: PERBAIKAN FILTER TANGGAL (AURORA DARK) ====== -->
<style>
.theme-aurora .filters-dark :is(
  input[type="date"],
  input[type="month"],
  select
){
  color-scheme: dark;
  background-color: rgba(15,23,42,.55) !important;
  color: #E5E7EB !important;
  border: 1px solid rgba(255,255,255,.22) !important;
  border-radius: 12px !important;
  height: 48px;
  padding: .6rem .9rem !important;
  outline: none;
}

/* Wrapper/filter box */
.theme-aurora .filters-dark :is(.form-group,.input-group,.form-control, .select, .box, .card){
  background-color: transparent !important;
}

.theme-aurora .filters-dark :is(input,select)::placeholder{ color: rgba(226,232,240,.75); }
.theme-aurora .filters-dark :is(input,select):focus{
  border-color: rgba(94,234,212,.55) !important;
  box-shadow: 0 0 0 2px rgba(94,234,212,.18);
}

/* ikon kalender putih */
.theme-aurora .filters-dark input[type="date"]::-webkit-calendar-picker-indicator,
.theme-aurora .filters-dark input[type="month"]::-webkit-calendar-picker-indicator{
  filter: invert(1) grayscale(1);
  opacity:.9;
}

/* panah dropdown putih */
.theme-aurora .filters-dark select{
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 24 24' width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M7 10l5 5 5-5' stroke='%23E5E7EB' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right .8rem center;
  background-size: 16px;
  padding-right: 2.2rem !important;
}

/* teks input tanggal di Android */
.theme-aurora .filters-dark input[type="date"]::-webkit-datetime-edit,
.theme-aurora .filters-dark input[type="date"]::-webkit-datetime-edit-text,
.theme-aurora .filters-dark input[type="date"]::-webkit-datetime-edit-month-field,
.theme-aurora .filters-dark input[type="date"]::-webkit-datetime-edit-day-field,
.theme-aurora .filters-dark input[type="date"]::-webkit-datetime-edit-year-field {
  color:#E5E7EB;
}

/* hindari autofill putih */
.theme-aurora .filters-dark :is(input,select):-webkit-autofill {
  -webkit-box-shadow: 0 0 0 1000px rgba(15,23,42,.55) inset !important;
  -webkit-text-fill-color: #E5E7EB !important;
}
</style>

<script>
// Tandai area filter agar CSS hanya berlaku di situ
(function(){
  const sections = Array.from(document.querySelectorAll('section,div,form,article'));
  const filterBlock = sections.find(el =>
    /Filter Berdasarkan/i.test(el.textContent || '') &&
    el.querySelector('input[type="date"], input[type="month"], select')
  );
  if (filterBlock) filterBlock.classList.add('filters-dark');

  // Gelapkan parent yang memaksa putih
  (filterBlock || document).querySelectorAll('input[type="date"], input[type="month"]').forEach(inp => {
    inp.style.backgroundColor = 'transparent';
    const box = inp.closest('.form-group, .input-group, .form-control, .select, .box, .card, div');
    if (box) {
      const bg = getComputedStyle(box).backgroundColor;
      if (bg === 'rgb(255, 255, 255)' || bg === 'rgba(255, 255, 255, 1)') {
        box.style.backgroundColor = 'rgba(15,23,42,.55)';
        box.style.border = '1px solid rgba(255,255,255,.22)';
        box.style.borderRadius = '12px';
      }
    }
  });
})();
</script>
<!-- ====== END PATCH ====== -->

<!-- ===== PATCH: iOS Glossy Glass Style for Select & Date Inputs ===== -->
<style>
.theme-aurora .filters-dark .glossy-wrap,
.theme-aurora .filters-dark .glass-date {
  position: relative;
  display: inline-block;
  width: 100%;
}

/* SELECT DROPDOWN GLOSSY */
.theme-aurora .filters-dark .glossy-wrap > select {
  appearance: none;
  -webkit-appearance: none;
  width: 100%;
  padding-right: 3rem !important;
  background: rgba(15,23,42,.55) !important;
  color: #E5E7EB !important;
  border: 1px solid rgba(255,255,255,.22) !important;
  border-radius: 12px !important;
  backdrop-filter: blur(12px) saturate(140%);
  -webkit-backdrop-filter: blur(12px) saturate(140%);
  transition: all .25s ease;
}

/* kapsul kaca di kanan select */
.theme-aurora .filters-dark .glossy-wrap::after {
  content: "";
  position: absolute;
  top: 50%; right: 8px;
  transform: translateY(-50%);
  width: 34px; height: 34px;
  border-radius: 12px;
  background:
    linear-gradient(135deg, rgba(255,255,255,.28), rgba(255,255,255,0) 40%),
    linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
  backdrop-filter: blur(10px) saturate(140%);
  -webkit-backdrop-filter: blur(10px) saturate(140%);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.35),
    inset 0 -1px 0 rgba(255,255,255,.18),
    0 2px 8px rgba(0,0,0,.35);
  border: 1px solid rgba(255,255,255,.28);
  pointer-events: none;
}

/* panah putih di atas kapsul kaca */
.theme-aurora .filters-dark .glossy-wrap::before {
  content: "";
  position: absolute;
  top: 50%; right: 8px;
  transform: translateY(-50%);
  width: 34px; height: 34px;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M7 10l5 5 5-5' stroke='%23FFFFFF' stroke-width='2.2' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: center;
  background-size: 16px;
  filter: drop-shadow(0 1px 1px rgba(0,0,0,.35));
  pointer-events: none;
}

/* hover glow */
.theme-aurora .filters-dark .glossy-wrap:hover::after,
.theme-aurora .filters-dark .glossy-wrap:focus-within::after {
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.45),
    inset 0 -1px 0 rgba(255,255,255,.25),
    0 3px 12px rgba(104,239,229,.25),
    0 0 0 2px rgba(94,234,212,.18);
  border-color: rgba(255,255,255,.38);
}

/* DATE / MONTH INPUT GLOSSY */
.theme-aurora .filters-dark .glass-date input[type="date"],
.theme-aurora .filters-dark .glass-date input[type="month"] {
  width: 100%;
  padding-right: 3rem !important;
  background: rgba(15,23,42,.55) !important;
  color: #E5E7EB !important;
  border: 1px solid rgba(255,255,255,.22) !important;
  border-radius: 12px !important;
  backdrop-filter: blur(12px) saturate(140%);
  -webkit-backdrop-filter: blur(12px) saturate(140%);
  transition: all .25s ease;
}

/* kapsul kaca ikon kalender */
.theme-aurora .filters-dark .glass-date::after {
  content: "";
  position: absolute;
  top: 50%; right: 8px;
  transform: translateY(-50%);
  width: 34px; height: 34px;
  border-radius: 12px;
  background:
    linear-gradient(135deg, rgba(255,255,255,.28), rgba(255,255,255,0) 40%),
    linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
  backdrop-filter: blur(10px) saturate(140%);
  -webkit-backdrop-filter: blur(10px) saturate(140%);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.35),
    inset 0 -1px 0 rgba(255,255,255,.18),
    0 2px 8px rgba(0,0,0,.35);
  border: 1px solid rgba(255,255,255,.28);
  pointer-events: none;
}

/* ikon kalender putih */
.theme-aurora .filters-dark .glass-date::before {
  content: "";
  position: absolute;
  top: 50%; right: 8px;
  transform: translateY(-50%);
  width: 34px; height: 34px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24'%3E%3Cpath fill='none' stroke='%23FFFFFF' stroke-width='2.2' stroke-linecap='round' stroke-linejoin='round' d='M16 2v4M8 2v4M3 10h18M4 5h16a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: center;
  background-size: 18px;
  filter: drop-shadow(0 1px 1px rgba(0,0,0,.35));
  pointer-events: none;
}

/* hover glow */
.theme-aurora .filters-dark .glass-date:hover::after,
.theme-aurora .filters-dark .glass-date:focus-within::after {
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.45),
    inset 0 -1px 0 rgba(255,255,255,.25),
    0 3px 12px rgba(104,239,229,.25),
    0 0 0 2px rgba(94,234,212,.18);
  border-color: rgba(255,255,255,.38);
}
</style>

<script>
(function(){
  const scope = document.querySelector('.filters-dark') || document;
  // Bungkus select
  scope.querySelectorAll('select').forEach(sel => {
    if (sel.closest('.glossy-wrap')) return;
    const wrap = document.createElement('span');
    wrap.className = 'glossy-wrap';
    sel.parentNode.insertBefore(wrap, sel);
    wrap.appendChild(sel);
  });
  // Bungkus input date/month
  scope.querySelectorAll('input[type="date"], input[type="month"]').forEach(inp => {
    if (inp.closest('.glass-date')) return;
    const wrap = document.createElement('span');
    wrap.className = 'glass-date';
    inp.parentNode.insertBefore(wrap, inp);
    wrap.appendChild(inp);
  });
})();
</script>
<!-- ===== END PATCH ===== -->

<!-- ===== PATCH: Fix white wrapper on filter controls (Aurora) ===== -->
<style id="filters-fix-white">
/* Hapus background putih pada container filter (dari .filter-control dsb) */
.theme-aurora .filters-dark .filter-control,
.theme-aurora .filters-dark .form-group,
.theme-aurora .filters-dark .input-group,
.theme-aurora .filters-dark .form-control-wrapper {
  background: transparent !important;
  box-shadow: none !important;
}

/* Pastikan label terlihat */
.theme-aurora .filters-dark label { color: #E5E7EB !important; opacity: .9; }

/* Sinkronisasi tinggi & alignment agar kapsul glossy pas */
.theme-aurora .filters-dark .glass-date,
.theme-aurora .filters-dark .glossy-wrap { display:block; width:100%; }

.theme-aurora .filters-dark .glass-date input[type="date"],
.theme-aurora .filters-dark .glass-date input[type="month"],
.theme-aurora .filters-dark .glossy-wrap > select {
  height: 48px !important;
  line-height: 48px !important;
  padding-left: 12px !important;
  padding-right: 3rem !important;
  box-sizing: border-box;
}

/* Sesuaikan ukuran & posisi kapsul glossy */
.theme-aurora .filters-dark .glass-date::after,
.theme-aurora .filters-dark .glass-date::before,
.theme-aurora .filters-dark .glossy-wrap::after,
.theme-aurora .filters-dark .glossy-wrap::before {
  right: 10px;
  width: 32px; height: 32px;
  border-radius: 10px;
}
</style>

<!-- ===== PATCH: Revert Dropdown Arrow to Normal ===== -->
<style id="dropdown-normal-arrow">
.theme-aurora .filters-dark select {
  appearance: auto !important;
  -webkit-appearance: auto !important;
  background: rgba(15,23,42,.55) !important;
  color: #E5E7EB !important;
  border: 1px solid rgba(255,255,255,.22) !important;
  border-radius: 12px !important;
  padding: .6rem .9rem !important;
}
.theme-aurora .filters-dark .glossy-wrap::before,
.theme-aurora .filters-dark .glossy-wrap::after {
  display: none !important;
}
</style>

<!-- ===== PATCH: Revert All Filters to Normal Style ===== -->
<style id="filters-normal">
.theme-aurora .filters-dark select,
.theme-aurora .filters-dark input[type="date"],
.theme-aurora .filters-dark input[type="month"] {
  appearance: auto !important;
  -webkit-appearance: auto !important;
  background: rgba(15,23,42,.55) !important;
  color: #E5E7EB !important;
  border: 1px solid rgba(255,255,255,.22) !important;
  border-radius: 10px !important;
  padding: .6rem .9rem !important;
  height: 48px !important;
  box-shadow: none !important;
}

/* Remove any glossy overlays */
.theme-aurora .filters-dark .glass-date::before,
.theme-aurora .filters-dark .glass-date::after,
.theme-aurora .filters-dark .glossy-wrap::before,
.theme-aurora .filters-dark .glossy-wrap::after {
  display: none !important;
}

/* Ensure wrappers are transparent and normal */
.theme-aurora .filters-dark .glass-date,
.theme-aurora .filters-dark .glossy-wrap {
  background: transparent !important;
  box-shadow: none !important;
  display: block !important;
  width: 100% !important;
  position: static !important;
}
</style>

<!-- ===== PATCH: Remove Theme Color Palette ===== -->
<style id="remove-theme-palette">
#app-settings .theme-color-options,
#app-settings .theme-color-palette,
.theme-selector .color-palette,
.theme-selector .color-options {
  display: none !important;
  visibility: hidden !important;
  height: 0 !important;
  overflow: hidden !important;
}
</style>

<!-- ===== PATCH: Force Remove Theme Color Palette (Dynamic Safe) ===== -->
<style id="force-hide-theme-color-palette">
.theme-color-options,
.theme-color-palette,
.color-palette,
.color-options,
.theme-selector .color-palette,
.theme-selector .color-options {
  display: none !important;
  visibility: hidden !important;
  height: 0 !important;
  overflow: hidden !important;
  margin: 0 !important;
  padding: 0 !important;
}
</style>

<script>
// Otomatis hapus kotak warna jika dibuat ulang oleh JS
(function hideThemePalettes(){
  const selectors = [
    '.theme-color-options',
    '.theme-color-palette',
    '.color-palette',
    '.color-options',
    '.theme-selector .color-palette',
    '.theme-selector .color-options'
  ];
  const hideAll = () => {
    selectors.forEach(sel => {
      document.querySelectorAll(sel).forEach(el => el.remove());
    });
  };
  hideAll();
  // Pantau perubahan DOM agar tetap tersembunyi walaupun di-render ulang
  const observer = new MutationObserver(hideAll);
  observer.observe(document.body, { childList: true, subtree: true });
})();
</script>

<!-- ===== PATCH: Robust Swatch Remover (size/shape heuristic) ===== -->
<script>
(function nukeThemeSwatches(){
  function findSettingsPanel(){
    const nodes = Array.from(document.querySelectorAll('div,section,aside,form,article'));
    return nodes.find(el =>
      /Pengaturan\s+Aplikasi/i.test(el.textContent || '') &&
      el.querySelector('select')
    ) || document.body;
  }

  function looksLikeSwatch(el){
    const cs = getComputedStyle(el);
    const w = el.clientWidth, h = el.clientHeight;
    const br = parseFloat(cs.borderTopLeftRadius) || 0;
    const bg = cs.backgroundColor;
    // heuristik: kotak kecil membulat, tidak transparan
    const squareish = Math.abs(w - h) <= 6 && w >= 12 && w <= 48 && h >= 12 && h <= 48;
    const rounded = br >= 6;
    const visible = cs.display !== 'none' && cs.visibility !== 'hidden';
    const notInput = !el.matches('select,option,input,label,textarea');
    return squareish && rounded && visible && notInput && bg !== 'rgba(0, 0, 0, 0)';
  }

  function removeSwatches(scope){
    const container = scope || findSettingsPanel();
    const all = Array.from(container.querySelectorAll('*'));
    all.forEach(el => {
      if (looksLikeSwatch(el)) {
        el.remove();
      }
    });
    // bersihkan baris/pembungkus yang kosong setelah swatch dihapus
    const wrappers = container.querySelectorAll('.row, .grid, .palette, .color-row, .theme-color-row, .theme-color, .color-palette, .color-options');
    wrappers.forEach(w => {
      if (!w.querySelector('select, input, label, button, textarea')) w.remove();
    });
  }

  // jalankan segera & amati DOM untuk render ulang dinamis
  const panel = findSettingsPanel();
  removeSwatches(panel);
  const mo = new MutationObserver(() => removeSwatches(panel));
  mo.observe(document.body, { childList: true, subtree: true });
})();
</script>

<!-- ===== PATCH: Replace Theme Dropdown with Dark Mode Toggle ===== -->
<style id="darkmode-toggle-style">
/* Switch container */
.theme-toggle{
  display:flex; align-items:center; gap:.75rem;
  padding:.25rem 0;
}
.theme-toggle .switch-label{
  color:#E5E7EB; font-weight:600; letter-spacing:.2px;
}
/* Track */
.theme-toggle .track{
  position:relative; width:56px; height:30px;
  border-radius:999px; background:rgba(148,163,184,.35);
  box-shadow: inset 0 2px 6px rgba(0,0,0,.35);
  transition:background .2s ease, box-shadow .2s ease;
  display:inline-block; vertical-align:middle;
}
/* Thumb */
.theme-toggle .thumb{
  position:absolute; top:3px; left:3px;
  width:24px; height:24px; border-radius:50%;
  background:linear-gradient(180deg, #ffffff, #dbeafe);
  box-shadow: 0 2px 6px rgba(0,0,0,.35), inset 0 -1px 0 rgba(0,0,0,.1);
  transition:transform .22s ease;
}
/* Native checkbox visually hidden but accessible */
.theme-toggle input[type="checkbox"]{
  position:absolute; width:1px; height:1px; overflow:hidden; clip:rect(0 0 0 0);
}
/* ON state */
.theme-toggle input:checked + .track{
  background:linear-gradient(180deg, rgba(45,212,191,.6), rgba(13,148,136,.55));
  box-shadow: inset 0 2px 6px rgba(0,0,0,.45), 0 0 0 2px rgba(94,234,212,.18);
}
.theme-toggle input:checked + .track .thumb{
  transform:translateX(26px);
  background:linear-gradient(180deg, #e6fffb, #ccfbf1);
}
/* Small helper text color for light mode */
body:not(.theme-aurora) .theme-toggle .switch-label{ color:#334155; }
</style>

<script id="darkmode-toggle-script">
(function(){
  // Find settings panel and the theme select
  function findSettingsPanel(){
    const nodes = Array.from(document.querySelectorAll('div,section,aside,form,article'));
    return nodes.find(el => /Pengaturan\\s+Aplikasi/i.test(el.textContent || '')) || document.body;
  }
  const panel = findSettingsPanel();
  const themeSelect = panel.querySelector('select');

  // Build toggle element
  const wrap = document.createElement('label');
  wrap.className = 'theme-toggle';
  wrap.innerHTML = '<input type="checkbox" id="darkModeToggle"><span class="track"><span class="thumb"></span></span><span class="switch-label">Dark Mode</span>';

  // Insert toggle: replace theme select row if exists, otherwise append
  if (themeSelect) {
    // hide the select and put toggle after its label
    themeSelect.style.display = 'none';
    const label = themeSelect.closest('label') || panel.querySelector('label:has(+ select), label[for="'+(themeSelect.id||'')+'"]');
    if (label && label.parentNode) {
      label.after(wrap);
    } else {
      themeSelect.parentNode.insertBefore(wrap, themeSelect);
    }
  } else {
    panel.prepend(wrap);
  }

  // Helpers to set theme & sync with legacy select/localStorage
  function setSelectValue(val){
    if (!themeSelect) return;
    const opts = Array.from(themeSelect.options);
    const target = opts.find(o => (o.text||'').toLowerCase().includes(val));
    if (target) themeSelect.value = target.value;
  }

  function applyTheme(isDark){
    if (isDark){
      document.body.classList.add('theme-aurora');
      localStorage.setItem('appTheme','dark');
      setSelectValue('dark');
    }else{
      document.body.classList.remove('theme-aurora');
      localStorage.setItem('appTheme','light');
      setSelectValue('light');
    }
  }

  // Initial state from storage or DOM
  const saved = localStorage.getItem('appTheme');
  const initialDark = saved ? (saved === 'dark') : document.body.classList.contains('theme-aurora');
  const checkbox = wrap.querySelector('#darkModeToggle');
  checkbox.checked = initialDark;
  applyTheme(initialDark);

  // Listen for changes
  checkbox.addEventListener('change', e => applyTheme(e.target.checked));
})();
</script>

<script id="wrap-logo-pill">
(function(){
  var img = document.querySelector('img.app-logo');
  if(!img) return;
  var parent = img.parentElement;
  if(parent && parent.classList.contains('logo-pill')) return; // already wrapped
  var pill = document.createElement('div');
  pill.className = 'logo-pill';
  parent.insertBefore(pill, img);
  pill.appendChild(img);
})();
</script>

</body>
</html>